//
// Created by 吴婷 on 2019-12-01.
//

#include "thirdparty/monitor_sdk_common/base/string/number.h"
#include "deserialize_utils.h"

#include "thirdparty/gtest/gtest.h"

namespace common{


TEST(VepDeserializeUtils, DeserializeLabVersionDtoList){
    std::string json_str = "[{\"id\":123,\"labId\":53,\"versionName\":\"v1\",\"description\":\"\",\"whitelist\":\"\",\"baselineState\":0,\"integrationState\":\"test_succeed\",\"labVariableName\":\"广告pctr模型01\",\"labVariableCode\":\"ad-pctr-model-01\",\"diversionType\":\"hash_imei\",\"diversionStrategy\":\"04\",\"trafficRatio\":10,\"interventionStrategy\":\"\",\"createTime\":1573089788000,\"updateTime\":1573089880255,\"params\":{\"pctr\":1,\"ds\":\"1\"},\"creator\":\"林承君\",\"modifier\":\"林承君\"},{\"id\":124,\"labId\":53,\"versionName\":\"v2\",\"description\":\"\",\"whitelist\":\"\",\"baselineState\":1,\"integrationState\":\"test_succeed\",\"labVariableName\":\"广告pctr模型01\",\"labVariableCode\":\"ad-pctr-model-01\",\"diversionType\":\"hash_imei\",\"diversionStrategy\":\"14\",\"trafficRatio\":10,\"interventionStrategy\":\"\",\"createTime\":1573089795000,\"updateTime\":1573089880256,\"params\":{\"pctr\":2,\"ds\":\"2\"},\"creator\":\"林承君\",\"modifier\":\"林承君\"}]";
    std::vector<std::shared_ptr<LabVersionDto> > lab_version_dtos;
    VepDeserializeUtils::DeserializeLabVersionDto(json_str, &lab_version_dtos);
    EXPECT_EQ(2, (int)(lab_version_dtos.size()));

    std::shared_ptr<LabVersionDto> lab_version_dto = lab_version_dtos[0];  //取出vector中的第一个
    EXPECT_EQ(123, lab_version_dto->id);
    EXPECT_EQ("广告pctr模型01", lab_version_dto->lab_variable_name);
    EXPECT_EQ(1573089788000, (long)(lab_version_dto->create_time));
    EXPECT_EQ(2, (int)(lab_version_dto->params.size()));

    EXPECT_EQ("1", lab_version_dto->params["ds"]);
    EXPECT_EQ("1", lab_version_dto->params["pctr"]);
}

TEST(VepDeserializeUtils, DeserializeLabVersionDtoMap){
    std::string json_str = "{\"125\":{\"id\":125,\"labId\":54,\"versionName\":\"v1\",\"description\":\"\",\"whitelist\":\"\",\"baselineState\":0,\"integrationState\":\"test_succeed\",\"labVariableName\":\"广告pctr模型01\",\"labVariableCode\":\"ad-pctr-model-01\",\"diversionType\":\"hash_imei\",\"diversionStrategy\":\"0,2,3,4,5,6,7,8,9\",\"trafficRatio\":900,\"interventionStrategy\":\"\",\"shuntTagStrategy\":\"\",\"createTime\":1573089983000,\"updateTime\":1573090420564,\"params\":{\"pctr\":1,\"ds\":\"1\"},\"creator\":\"林承君\",\"modifier\":\"林承君\"},\"126\":{\"id\":126,\"labId\":54,\"versionName\":\"v2\",\"description\":\"\",\"whitelist\":\"\",\"baselineState\":1,\"integrationState\":\"test_succeed\",\"labVariableName\":\"广告pctr模型01\",\"labVariableCode\":\"ad-pctr-model-01\",\"diversionType\":\"hash_imei\",\"diversionStrategy\":\"1\",\"trafficRatio\":100,\"interventionStrategy\":\"\",\"shuntTagStrategy\":\"\",\"createTime\":1573090086000,\"updateTime\":1573090420564,\"params\":{\"pctr\":2,\"ds\":\"2\"},\"creator\":\"林承君\",\"modifier\":\"林承君\"}}";

    std::map<int, std::shared_ptr<LabVersionDto> > version_map;
    VepDeserializeUtils::DeserializeLabVersionDto(json_str, &version_map);
    EXPECT_EQ(2, (int)(version_map.size()));

    std::shared_ptr<LabVersionDto> lab_version_dto = version_map[125];  //取出vector中的第一个
    EXPECT_EQ(125, lab_version_dto->id);
    EXPECT_EQ("广告pctr模型01", lab_version_dto->lab_variable_name);
    EXPECT_EQ(1573089983000, (long)(lab_version_dto->create_time));
    EXPECT_EQ(2, (int)(lab_version_dto->params.size()));

    EXPECT_EQ("1", lab_version_dto->params["ds"]);
    EXPECT_EQ("1", lab_version_dto->params["pctr"]);
}

TEST(VepDeserializeUtils, VepApiLabWithPositionVo){
    std::string json_str = "{\"id\":53,\"labName\":\"lab-1108-1\",\"description\":\"\",\"factor\":\"\",\"labState\":\"effective\",\"labType\":\"algorithm\",\"moduleId\":12,\"sceneId\":37,\"sceneCode\":\"scene_1108\",\"trafficAllocationType\":\"segment\",\"bizLineName\":\"ad\",\"createTime\":1573089775966,\"updateTime\":1574915260470,\"creator\":\"林承君\",\"modifier\":\"张振威\",\"hashEncrypt\":1,\"hashSwitch\":1,\"subType\":\"flowControl\",\"relatedLayer\":1,\"layerId\":29,\"moduleCode\":\"ad_1107\",\"moduleName\":\"广告1107\",\"sceneName\":\"scene_1108\",\"versionCount\":2,\"withThirdParty\":1,\"thirdBizType\":\"ad\",\"layerCode\":\"predict_1107\",\"layerName\":\"predict层\",\"versionList\":[{\"id\":123,\"labId\":53,\"versionName\":\"v1\",\"description\":\"\",\"whitelist\":\"\",\"baselineState\":0,\"integrationState\":\"test_succeed\",\"labVariableName\":\"广告pctr模型01\",\"labVariableCode\":\"ad-pctr-model-01\",\"diversionType\":\"hash_imei\",\"diversionStrategy\":\"04\",\"trafficRatio\":10,\"interventionStrategy\":\"\",\"createTime\":1573089788000,\"updateTime\":1573089880255,\"params\":{\"pctr\":1,\"ds\":\"1\"},\"creator\":\"林承君\",\"modifier\":\"林承君\"},{\"id\":124,\"labId\":53,\"versionName\":\"v2\",\"description\":\"\",\"whitelist\":\"\",\"baselineState\":1,\"integrationState\":\"test_succeed\",\"labVariableName\":\"广告pctr模型01\",\"labVariableCode\":\"ad-pctr-model-01\",\"diversionType\":\"hash_imei\",\"diversionStrategy\":\"14\",\"trafficRatio\":10,\"interventionStrategy\":\"\",\"createTime\":1573089795000,\"updateTime\":1573089880256,\"params\":{\"pctr\":2,\"ds\":\"2\"},\"creator\":\"林承君\",\"modifier\":\"林承君\"}],\"trafficPositions\":[\"1\",\"2\"]}";
    std::shared_ptr<VepApiLabWithPositionVo> vepApiLabWithPositionVo = std::make_shared<VepApiLabWithPositionVo>();
    VepDeserializeUtils::DeserializeVepApiLabWithPositionVo(json_str, vepApiLabWithPositionVo);

    EXPECT_EQ(53, vepApiLabWithPositionVo->id);
    EXPECT_EQ("ad", vepApiLabWithPositionVo->biz_line_name);
    EXPECT_EQ(1573089775966, (long)(vepApiLabWithPositionVo->create_time));
    EXPECT_EQ(2, (int)(vepApiLabWithPositionVo->version_list.size()));
    EXPECT_EQ("test_succeed", vepApiLabWithPositionVo->version_list[1]->integration_state);

    EXPECT_EQ(2, (int)(vepApiLabWithPositionVo->traffic_positions.size()));
    EXPECT_EQ("1", vepApiLabWithPositionVo->traffic_positions[0]);
}

TEST(VepDeserializeUtils, VepApiLayerTrafficVo){
    std::string json_str ="{\"layer\":{\"id\":29,\"code\":\"predict_1107\",\"name\":\"predict层\",\"bizLineName\":\"ad\",\"shuntField\":\"IMEI\",\"saltSwitch\":1,\"saltLocation\":1,\"salt\":\"predict_1107\",\"encryptSwitch\":1,\"hashSwitch\":1,\"creator\":\"林承君\",\"modifier\":\"\",\"createTime\":1573070247422,\"updateTime\":1573070247422,\"enable\":1,\"shuntTagType\":\"\"},\"labList\":[{\"id\":88,\"labName\":\"lab-1204-lin\",\"description\":\"\",\"factor\":\"predict_1107\",\"labState\":\"not_starting\",\"labType\":\"algorithm\",\"moduleId\":12,\"sceneId\":37,\"sceneCode\":\"scene_1108\",\"trafficAllocationType\":null,\"bizLineName\":\"ad\",\"createTime\":1575438363475,\"updateTime\":1575438363475,\"creator\":\"林承君\",\"modifier\":\"\",\"hashEncrypt\":1,\"hashSwitch\":1,\"subType\":\"flowControl\",\"relatedLayer\":1,\"layerId\":29,\"shuntField\":null,\"shuntTagType\":null,\"saltSwitch\":null,\"saltLocation\":null,\"moduleCode\":\"ad_1107\",\"moduleName\":\"广告1107\",\"sceneName\":\"scene_1108\",\"versionCount\":2,\"withThirdParty\":1,\"thirdBizType\":\"ad\",\"layerCode\":\"predict_1107\",\"layerName\":\"predict层\",\"versionList\":[{\"id\":190,\"labId\":88,\"versionName\":\"v1\",\"description\":\"\",\"whitelist\":\"\",\"baselineState\":1,\"integrationState\":\"test_succeed\",\"labVariableName\":\"广告pctr模型01\",\"labVariableCode\":\"ad-pctr-model-01\",\"diversionType\":\"hash_imei\",\"diversionStrategy\":\"\",\"trafficRatio\":0,\"interventionStrategy\":\"\",\"shuntTagStrategy\":\"\",\"createTime\":1575438372094,\"updateTime\":1575438380249,\"params\":{\"pctr\":1,\"ds\":\"1\"},\"creator\":\"林承君\",\"modifier\":\"\"},{\"id\":191,\"labId\":88,\"versionName\":\"v2\",\"description\":\"\",\"whitelist\":\"\",\"baselineState\":1,\"integrationState\":\"test_succeed\",\"labVariableName\":\"广告pctr模型01\",\"labVariableCode\":\"ad-pctr-model-01\",\"diversionType\":\"hash_imei\",\"diversionStrategy\":\"\",\"trafficRatio\":0,\"interventionStrategy\":\"\",\"shuntTagStrategy\":\"\",\"createTime\":1575438378560,\"updateTime\":1575438381182,\"params\":{\"pctr\":2,\"ds\":\"2\"},\"creator\":\"林承君\",\"modifier\":\"\"}],\"trafficPositions\":[\"1\",\"2\"]},{\"id\":53,\"labName\":\"lab-1108-1\",\"description\":\"\",\"factor\":\"\",\"labState\":\"effective\",\"labType\":\"algorithm\",\"moduleId\":12,\"sceneId\":37,\"sceneCode\":\"scene_1108\",\"trafficAllocationType\":\"segment\",\"bizLineName\":\"ad\",\"createTime\":1573089775966,\"updateTime\":1574915260470,\"creator\":\"林承君\",\"modifier\":\"张振威\",\"hashEncrypt\":1,\"hashSwitch\":1,\"subType\":\"flowControl\",\"relatedLayer\":1,\"layerId\":29,\"shuntField\":null,\"shuntTagType\":null,\"saltSwitch\":null,\"saltLocation\":null,\"moduleCode\":\"ad_1107\",\"moduleName\":\"广告1107\",\"sceneName\":\"scene_1108\",\"versionCount\":2,\"withThirdParty\":1,\"thirdBizType\":\"ad\",\"layerCode\":\"predict_1107\",\"layerName\":\"predict层\",\"versionList\":[{\"id\":123,\"labId\":53,\"versionName\":\"v1\",\"description\":\"\",\"whitelist\":\"\",\"baselineState\":0,\"integrationState\":\"test_succeed\",\"labVariableName\":\"广告pctr模型01\",\"labVariableCode\":\"ad-pctr-model-01\",\"diversionType\":\"hash_imei\",\"diversionStrategy\":\"04\",\"trafficRatio\":10,\"interventionStrategy\":\"\",\"shuntTagStrategy\":\"\",\"createTime\":1573089788000,\"updateTime\":1573089880255,\"params\":{\"pctr\":1,\"ds\":\"1\"},\"creator\":\"林承君\",\"modifier\":\"林承君\"},{\"id\":124,\"labId\":53,\"versionName\":\"v2\",\"description\":\"\",\"whitelist\":\"\",\"baselineState\":1,\"integrationState\":\"test_succeed\",\"labVariableName\":\"广告pctr模型01\",\"labVariableCode\":\"ad-pctr-model-01\",\"diversionType\":\"hash_imei\",\"diversionStrategy\":\"14\",\"trafficRatio\":10,\"interventionStrategy\":\"\",\"shuntTagStrategy\":\"\",\"createTime\":1573089795000,\"updateTime\":1573089880256,\"params\":{\"pctr\":2,\"ds\":\"2\"},\"creator\":\"林承君\",\"modifier\":\"林承君\"}],\"trafficPositions\":[\"1\",\"2\"]},{\"id\":61,\"labName\":\"zlab1125\",\"description\":\"zlab1125\",\"factor\":\"s\",\"labState\":\"not_starting\",\"labType\":\"algorithm\",\"moduleId\":3,\"sceneId\":16,\"sceneCode\":\"code789\",\"trafficAllocationType\":\"segment\",\"bizLineName\":\"ad\",\"createTime\":1574643458785,\"updateTime\":1574708295779,\"creator\":\"张振威\",\"modifier\":\"李冕\",\"hashEncrypt\":1,\"hashSwitch\":1,\"subType\":\"flowControl\",\"relatedLayer\":1,\"layerId\":29,\"shuntField\":null,\"shuntTagType\":null,\"saltSwitch\":null,\"saltLocation\":null,\"moduleCode\":\"code1wa\",\"moduleName\":\"应用1\",\"sceneName\":\"不关联第三方数据源场景1\",\"versionCount\":2,\"withThirdParty\":0,\"thirdBizType\":\"ad\",\"layerCode\":\"predict_1107\",\"layerName\":\"predict层\",\"versionList\":[{\"id\":138,\"labId\":61,\"versionName\":\"v1\",\"description\":\"\",\"whitelist\":\"\",\"baselineState\":1,\"integrationState\":\"test_succeed\",\"labVariableName\":\"广告参数模板测试默认值\",\"labVariableCode\":\"codeAd12\",\"diversionType\":\"hash_imei\",\"diversionStrategy\":\"\",\"trafficRatio\":0,\"interventionStrategy\":\"\",\"shuntTagStrategy\":\"\",\"createTime\":1574643469717,\"updateTime\":1574643479935,\"params\":{\"a\":1,\"b\":\"as\"},\"creator\":\"张振威\",\"modifier\":\"\"},{\"id\":139,\"labId\":61,\"versionName\":\"v2\",\"description\":\"\",\"whitelist\":\"\",\"baselineState\":1,\"integrationState\":\"test_succeed\",\"labVariableName\":\"20190921_大模型v3\",\"labVariableCode\":\"vivo-ctr-v3\",\"diversionType\":\"hash_imei\",\"diversionStrategy\":\"\",\"trafficRatio\":0,\"interventionStrategy\":\"\",\"shuntTagStrategy\":\"\",\"createTime\":1574643476370,\"updateTime\":1574643480344,\"params\":{},\"creator\":\"张振威\",\"modifier\":\"\"}],\"trafficPositions\":null},{\"id\":55,\"labName\":\"lab-test-1108\",\"description\":\"\",\"factor\":\"\",\"labState\":\"effective\",\"labType\":\"algorithm\",\"moduleId\":12,\"sceneId\":38,\"sceneCode\":\"scene_1106\",\"trafficAllocationType\":\"segment\",\"bizLineName\":\"ad\",\"createTime\":1573164491603,\"updateTime\":1574209688713,\"creator\":\"林承君\",\"modifier\":\"李冕\",\"hashEncrypt\":1,\"hashSwitch\":1,\"subType\":\"flowControl\",\"relatedLayer\":1,\"layerId\":29,\"shuntField\":null,\"shuntTagType\":null,\"saltSwitch\":null,\"saltLocation\":null,\"moduleCode\":\"ad_1107\",\"moduleName\":\"广告1107\",\"sceneName\":\"scene_1106\",\"versionCount\":2,\"withThirdParty\":0,\"thirdBizType\":\"\",\"layerCode\":\"predict_1107\",\"layerName\":\"predict层\",\"versionList\":[{\"id\":127,\"labId\":55,\"versionName\":\"v1\",\"description\":\"\",\"whitelist\":\"\",\"baselineState\":0,\"integrationState\":\"test_succeed\",\"labVariableName\":\"广告pctr模型01\",\"labVariableCode\":\"ad-pctr-model-01\",\"diversionType\":\"hash_imei\",\"diversionStrategy\":\"0\",\"trafficRatio\":100,\"interventionStrategy\":\"\",\"shuntTagStrategy\":\"\",\"createTime\":1573164501000,\"updateTime\":1573164543150,\"params\":{\"pctr\":1,\"ds\":\"1\"},\"creator\":\"林承君\",\"modifier\":\"林承君\"},{\"id\":128,\"labId\":55,\"versionName\":\"v2\",\"description\":\"\",\"whitelist\":\"\",\"baselineState\":1,\"integrationState\":\"test_succeed\",\"labVariableName\":\"广告pctr模型01\",\"labVariableCode\":\"ad-pctr-model-01\",\"diversionType\":\"hash_imei\",\"diversionStrategy\":\"1\",\"trafficRatio\":100,\"interventionStrategy\":\"\",\"shuntTagStrategy\":\"\",\"createTime\":1573164510000,\"updateTime\":1573164543151,\"params\":{\"pctr\":2,\"ds\":\"2\"},\"creator\":\"林承君\",\"modifier\":\"林承君\"}],\"trafficPositions\":null},{\"id\":52,\"labName\":\"lab-1107-3\",\"description\":\"\",\"factor\":\"\",\"labState\":\"effective\",\"labType\":\"algorithm\",\"moduleId\":12,\"sceneId\":35,\"sceneCode\":\"scene_1107\",\"trafficAllocationType\":\"segment\",\"bizLineName\":\"ad\",\"createTime\":1573088743747,\"updateTime\":1573088824402,\"creator\":\"林承君\",\"modifier\":\"林承君\",\"hashEncrypt\":1,\"hashSwitch\":1,\"subType\":\"flowControl\",\"relatedLayer\":1,\"layerId\":29,\"shuntField\":null,\"shuntTagType\":null,\"saltSwitch\":null,\"saltLocation\":null,\"moduleCode\":\"ad_1107\",\"moduleName\":\"广告1107\",\"sceneName\":\"场景1107\",\"versionCount\":3,\"withThirdParty\":1,\"thirdBizType\":\"ad\",\"layerCode\":\"predict_1107\",\"layerName\":\"predict层\",\"versionList\":[{\"id\":120,\"labId\":52,\"versionName\":\"v1\",\"description\":\"\",\"whitelist\":\"\",\"baselineState\":0,\"integrationState\":\"test_succeed\",\"labVariableName\":\"广告pctr模型01\",\"labVariableCode\":\"ad-pctr-model-01\",\"diversionType\":\"hash_imei\",\"diversionStrategy\":\"0\",\"trafficRatio\":100,\"interventionStrategy\":\"\",\"shuntTagStrategy\":\"\",\"createTime\":1573088752000,\"updateTime\":1573088824395,\"params\":{\"pctr\":1,\"ds\":\"1\"},\"creator\":\"林承君\",\"modifier\":\"林承君\"},{\"id\":121,\"labId\":52,\"versionName\":\"v2\",\"description\":\"\",\"whitelist\":\"\",\"baselineState\":1,\"integrationState\":\"test_succeed\",\"labVariableName\":\"广告pctr模型01\",\"labVariableCode\":\"ad-pctr-model-01\",\"diversionType\":\"hash_imei\",\"diversionStrategy\":\"1\",\"trafficRatio\":100,\"interventionStrategy\":\"\",\"shuntTagStrategy\":\"\",\"createTime\":1573088760000,\"updateTime\":1573088824395,\"params\":{\"pctr\":2,\"ds\":\"2\"},\"creator\":\"林承君\",\"modifier\":\"林承君\"},{\"id\":122,\"labId\":52,\"versionName\":\"v3\",\"description\":\"\",\"whitelist\":\"\",\"baselineState\":1,\"integrationState\":\"test_succeed\",\"labVariableName\":\"广告pctr模型01\",\"labVariableCode\":\"ad-pctr-model-01\",\"diversionType\":\"hash_imei\",\"diversionStrategy\":\"2\",\"trafficRatio\":100,\"interventionStrategy\":\"\",\"shuntTagStrategy\":\"\",\"createTime\":1573088773000,\"updateTime\":1573088824395,\"params\":{\"pctr\":3,\"ds\":\"3\"},\"creator\":\"林承君\",\"modifier\":\"林承君\"}],\"trafficPositions\":[\"1\",\"2\",\"3\"]}],\"lastLayerChangingTime\":1575500206273}";
    std::shared_ptr<VepApiLayerTrafficVo> layer_traffic_vo = std::make_shared<VepApiLayerTrafficVo>();
    VepDeserializeUtils::DeserializeVepApiLayerTrafficVo(json_str, layer_traffic_vo);

    EXPECT_EQ(29, layer_traffic_vo->layer.id);
    EXPECT_EQ("ad", layer_traffic_vo->layer.biz_line_name);
    EXPECT_EQ(1573070247422, (long)(layer_traffic_vo->layer.create_time));

    EXPECT_EQ(5, (int)(layer_traffic_vo->lab_list.size()));

    EXPECT_EQ(2, (int)(layer_traffic_vo->lab_list[0]->version_list.size()));
    EXPECT_EQ("test_succeed", layer_traffic_vo->lab_list[0]->version_list[1]->integration_state);

    EXPECT_EQ(2, (int)(layer_traffic_vo->lab_list[0]->traffic_positions.size()));
    EXPECT_EQ("1", layer_traffic_vo->lab_list[0]->traffic_positions[0]);

    EXPECT_EQ(3, (int)(layer_traffic_vo->lab_list[4]->traffic_positions.size()));
    EXPECT_EQ("3", layer_traffic_vo->lab_list[4]->traffic_positions[2]);
}


TEST(VepDeserializeUtils, DeserializeRelatedLayerRelevanceChangeDto){
    std::string json_str = "{\"bizLineName\":\"ad\",\"changeType\":\"CHANGE_OF_WHITELIST\",\"createTime\":1575247013771,\"id\":324,\"layerCode\":\"pctr\",\"layerId\":1,\"layerName\":\"jajaja\",\"operator\":\"林承君\",\"relatedKey\":\"pctr\",\"relatedVal\":\"{\\\"bizLineName\\\":\\\"ad\\\",\\\"createTime\\\":1568081192100,\\\"creator\\\":\\\"林承君\\\",\\\"description\\\":\\\"lb-0910-01\\\",\\\"factor\\\":\\\"\\\",\\\"hashEncrypt\\\":1,\\\"hashSwitch\\\":1,\\\"id\\\":10,\\\"labName\\\":\\\"lab-0910-01\\\",\\\"labState\\\":\\\"effective\\\",\\\"labType\\\":\\\"strategy\\\",\\\"layerCode\\\":\\\"pctr\\\",\\\"layerId\\\":1,\\\"layerName\\\":\\\"jajaja\\\",\\\"modifier\\\":\\\"林承君\\\",\\\"moduleCode\\\":\\\"ad-center\\\",\\\"moduleId\\\":4,\\\"moduleName\\\":\\\"广告\\\",\\\"relatedLayer\\\":1,\\\"saltLocation\\\":1,\\\"saltSwitch\\\":1,\\\"sceneCode\\\":\\\"ad_scene_1\\\",\\\"sceneId\\\":6,\\\"sceneName\\\":\\\"广告测试场景1\\\",\\\"shuntField\\\":\\\"IMEI\\\",\\\"shuntTagType\\\":\\\"\\\",\\\"subType\\\":\\\"flowControl\\\",\\\"thirdBizType\\\":\\\"ad\\\",\\\"trafficAllocationType\\\":\\\"segment\\\",\\\"updateTime\\\":1568081758878,\\\"withThirdParty\\\":1}\",\"remark\":\"\"}";

    std::shared_ptr<RelatedLayerRelevanceChangeDto> relatedLayerRelevanceChangeDto = std::make_shared<RelatedLayerRelevanceChangeDto>();
    VepDeserializeUtils::DeserializeRelatedLayerRelevanceChangeDto(json_str, relatedLayerRelevanceChangeDto);
    EXPECT_EQ(true, VepDeserializeUtils::DeserializeRelatedLayerRelevanceChangeDto(json_str, relatedLayerRelevanceChangeDto));
    EXPECT_EQ(1575247013771, (long)(relatedLayerRelevanceChangeDto->create_time));
    EXPECT_EQ("jajaja", relatedLayerRelevanceChangeDto->layer_name);
}

TEST(VepDeserializeUtils, DeserializeVepApiLayerFetchVo){
    std::string json_str = "{\"changeList\":[{\"bizLineName\":\"cpd\",\"changeType\":\"CHANGE_OF_WHITELIST\",\"createTime\":1574791574601,\"id\":294,\"layerCode\":\"pctr1\",\"layerId\":4,\"layerName\":\"pCTR层1\",\"operator\":\"李冕\",\"relatedKey\":\"pctr1\",\"relatedVal\":\"{\\\"bizLineName\\\":\\\"cpd\\\",\\\"createTime\\\":1568679897267,\\\"creator\\\":\\\"李冕\\\",\\\"description\\\":\\\"\\\",\\\"factor\\\":\\\"qwer12\\\",\\\"hashEncrypt\\\":1,\\\"hashSwitch\\\":1,\\\"id\\\":15,\\\"labName\\\":\\\"测试0917\\\",\\\"labState\\\":\\\"not_starting\\\",\\\"labType\\\":\\\"algorithm\\\",\\\"layerCode\\\":\\\"pctr1\\\",\\\"layerId\\\":4,\\\"layerName\\\":\\\"pCTR层1\\\",\\\"modifier\\\":\\\"\\\",\\\"moduleCode\\\":\\\"ad-center\\\",\\\"moduleId\\\":4,\\\"moduleName\\\":\\\"广告\\\",\\\"relatedLayer\\\":1,\\\"sceneCode\\\":\\\"ad_scene_5\\\",\\\"sceneId\\\":10,\\\"sceneName\\\":\\\"广告测试场景5\\\",\\\"subType\\\":\\\"flowControl\\\",\\\"thirdBizType\\\":\\\"ad\\\",\\\"updateTime\\\":1572377107528,\\\"withThirdParty\\\":1}\",\"remark\":\"\"},{\"bizLineName\":\"content-rec\",\"changeType\":\"CHANGE_OF_LAYER\",\"createTime\":1574790700614,\"id\":293,\"layerCode\":\"code_1127\",\"layerId\":34,\"layerName\":\"前端测试11271\",\"operator\":\"李冕\",\"relatedKey\":\"code_1127\",\"relatedVal\":\"{\\\"bizLineName\\\":\\\"content-rec\\\",\\\"code\\\":\\\"code_1127\\\",\\\"creator\\\":\\\"李冕\\\",\\\"encryptSwitch\\\":1,\\\"hashSwitch\\\":1,\\\"id\\\":34,\\\"modifier\\\":\\\"\\\",\\\"name\\\":\\\"前端测试11271\\\",\\\"salt\\\":\\\"\\\",\\\"saltLocation\\\":1,\\\"saltSwitch\\\":1,\\\"shuntField\\\":\\\"IMEI\\\"}\",\"remark\":\"add\"},{\"bizLineName\":\"ad\",\"changeType\":\"CHANGE_OF_LAYER\",\"createTime\":1574480627429,\"id\":292,\"layerCode\":\"code_asdg\",\"layerId\":31,\"layerName\":\"前端测试111102\",\"operator\":\"\",\"relatedKey\":\"code_asdg\",\"relatedVal\":\"{\\\"bizLineName\\\":\\\"ad\\\",\\\"createTime\\\":1574480108213,\\\"creator\\\":\\\"张振威\\\",\\\"description\\\":\\\"\\\",\\\"factor\\\":\\\"\\\",\\\"hashEncrypt\\\":1,\\\"hashSwitch\\\":1,\\\"id\\\":59,\\\"labName\\\":\\\"jj\\\",\\\"labState\\\":\\\"deleted\\\",\\\"labType\\\":\\\"algorithm\\\",\\\"layerCode\\\":\\\"code_asdg\\\",\\\"layerId\\\":31,\\\"layerName\\\":\\\"前端测试111102\\\",\\\"modifier\\\":\\\"\\\",\\\"moduleCode\\\":\\\"ad0920\\\",\\\"moduleId\\\":7,\\\"moduleName\\\":\\\"广告0921\\\",\\\"relatedLayer\\\":1,\\\"sceneCode\\\":\\\"routine_test\\\",\\\"sceneId\\\":27,\\\"sceneName\\\":\\\"routine测试\\\",\\\"subType\\\":\\\"flowControl\\\",\\\"thirdBizType\\\":\\\"ad\\\",\\\"updateTime\\\":1574480627423,\\\"withThirdParty\\\":1}\",\"remark\":\"lab-deleted\"},{\"bizLineName\":\"ad\",\"changeType\":\"CHANGE_OF_LAYER\",\"createTime\":1574480619088,\"id\":291,\"layerCode\":\"zlayer1123\",\"layerId\":33,\"layerName\":\"zlayer1123\",\"operator\":\"张振威\",\"relatedKey\":\"zlayer1123\",\"relatedVal\":\"{\\\"bizLineName\\\":\\\"ad\\\",\\\"code\\\":\\\"zlayer1123\\\",\\\"creator\\\":\\\"张振威\\\",\\\"encryptSwitch\\\":0,\\\"hashSwitch\\\":0,\\\"id\\\":33,\\\"modifier\\\":\\\"\\\",\\\"name\\\":\\\"zlayer1123\\\",\\\"salt\\\":\\\"1234\\\",\\\"saltLocation\\\":2,\\\"saltSwitch\\\":1,\\\"shuntField\\\":\\\"IMEI\\\"}\",\"remark\":\"add\"},{\"bizLineName\":\"ad\",\"changeType\":\"CHANGE_OF_VAR_PARAM\",\"createTime\":1574127029551,\"id\":290,\"layerCode\":\"layer1028\",\"layerId\":26,\"layerName\":\"layer1028\",\"operator\":\"张振威\",\"relatedKey\":\"layer1028\",\"relatedVal\":\"{\\\"bizLineName\\\":\\\"ad\\\",\\\"createTime\\\":1572831393113,\\\"creator\\\":\\\"林承君\\\",\\\"description\\\":\\\"\\\",\\\"factor\\\":\\\"\\\",\\\"hashEncrypt\\\":1,\\\"hashSwitch\\\":1,\\\"id\\\":46,\\\"labName\\\":\\\"lab-1104\\\",\\\"labState\\\":\\\"effective\\\",\\\"labType\\\":\\\"algorithm\\\",\\\"layerCode\\\":\\\"layer1028\\\",\\\"layerId\\\":26,\\\"layerName\\\":\\\"layer1028\\\",\\\"modifier\\\":\\\"张振威\\\",\\\"moduleCode\\\":\\\"ad0920\\\",\\\"moduleId\\\":7,\\\"moduleName\\\":\\\"广告0921\\\",\\\"relatedLayer\\\":1,\\\"sceneCode\\\":\\\"scene_0920_02\\\",\\\"sceneId\\\":21,\\\"sceneName\\\":\\\"测试场景092002\\\",\\\"subType\\\":\\\"flowControl\\\",\\\"thirdBizType\\\":\\\"ad\\\",\\\"trafficAllocationType\\\":\\\"segment\\\",\\\"updateTime\\\":1574119458100,\\\"withThirdParty\\\":1}\",\"remark\":\"\"},{\"bizLineName\":\"ad\",\"changeType\":\"CHANGE_OF_VAR_PARAM\",\"createTime\":1574119467593,\"id\":289,\"layerCode\":\"layer1028\",\"layerId\":26,\"layerName\":\"layer1028\",\"operator\":\"张振威\",\"relatedKey\":\"layer1028\",\"relatedVal\":\"{\\\"bizLineName\\\":\\\"ad\\\",\\\"createTime\\\":1572831393113,\\\"creator\\\":\\\"林承君\\\",\\\"description\\\":\\\"\\\",\\\"factor\\\":\\\"\\\",\\\"hashEncrypt\\\":1,\\\"hashSwitch\\\":1,\\\"id\\\":46,\\\"labName\\\":\\\"lab-1104\\\",\\\"labState\\\":\\\"effective\\\",\\\"labType\\\":\\\"algorithm\\\",\\\"layerCode\\\":\\\"layer1028\\\",\\\"layerId\\\":26,\\\"layerName\\\":\\\"layer1028\\\",\\\"modifier\\\":\\\"张振威\\\",\\\"moduleCode\\\":\\\"ad0920\\\",\\\"moduleId\\\":7,\\\"moduleName\\\":\\\"广告0921\\\",\\\"relatedLayer\\\":1,\\\"sceneCode\\\":\\\"scene_0920_02\\\",\\\"sceneId\\\":21,\\\"sceneName\\\":\\\"测试场景092002\\\",\\\"subType\\\":\\\"flowControl\\\",\\\"thirdBizType\\\":\\\"ad\\\",\\\"trafficAllocationType\\\":\\\"segment\\\",\\\"updateTime\\\":1574119458100,\\\"withThirdParty\\\":1}\",\"remark\":\"\"},{\"bizLineName\":\"ad\",\"changeType\":\"CHANGE_OF_LAYER\",\"createTime\":1574119458108,\"id\":288,\"layerCode\":\"layer1028\",\"layerId\":26,\"layerName\":\"layer1028\",\"operator\":\"张振威\",\"relatedKey\":\"layer1028\",\"relatedVal\":\"{\\\"bizLineName\\\":\\\"ad\\\",\\\"createTime\\\":1572831393113,\\\"creator\\\":\\\"林承君\\\",\\\"description\\\":\\\"\\\",\\\"factor\\\":\\\"\\\",\\\"hashEncrypt\\\":1,\\\"hashSwitch\\\":1,\\\"id\\\":46,\\\"labName\\\":\\\"lab-1104\\\",\\\"labState\\\":\\\"effective\\\",\\\"labType\\\":\\\"algorithm\\\",\\\"layerCode\\\":\\\"layer1028\\\",\\\"layerId\\\":26,\\\"layerName\\\":\\\"layer1028\\\",\\\"modifier\\\":\\\"张振威\\\",\\\"moduleCode\\\":\\\"ad0920\\\",\\\"moduleId\\\":7,\\\"moduleName\\\":\\\"广告0921\\\",\\\"relatedLayer\\\":1,\\\"sceneCode\\\":\\\"scene_0920_02\\\",\\\"sceneId\\\":21,\\\"sceneName\\\":\\\"测试场景092002\\\",\\\"subType\\\":\\\"flowControl\\\",\\\"thirdBizType\\\":\\\"ad\\\",\\\"trafficAllocationType\\\":\\\"segment\\\",\\\"updateTime\\\":1574119458100,\\\"withThirdParty\\\":1}\",\"remark\":\"lab-effective\"},{\"bizLineName\":\"ad\",\"changeType\":\"CHANGE_OF_VAR_PARAM\",\"createTime\":1574119399683,\"id\":287,\"layerCode\":\"zLayer116\",\"layerId\":28,\"layerName\":\"zLayer116\",\"operator\":\"张振威\",\"relatedKey\":\"zLayer116\",\"relatedVal\":\"{\\\"bizLineName\\\":\\\"ad\\\",\\\"createTime\\\":1573237303953,\\\"creator\\\":\\\"张振威\\\",\\\"description\\\":\\\"zLab119\\\",\\\"factor\\\":\\\"\\\",\\\"hashEncrypt\\\":1,\\\"hashSwitch\\\":1,\\\"id\\\":56,\\\"labName\\\":\\\"zLab119\\\",\\\"labState\\\":\\\"not_starting\\\",\\\"labType\\\":\\\"algorithm\\\",\\\"layerCode\\\":\\\"zLayer116\\\",\\\"layerId\\\":28,\\\"layerName\\\":\\\"zLayer116\\\",\\\"modifier\\\":\\\"张振威\\\",\\\"moduleCode\\\":\\\"ad-center\\\",\\\"moduleId\\\":4,\\\"moduleName\\\":\\\"广告\\\",\\\"relatedLayer\\\":1,\\\"sceneCode\\\":\\\"zScene117\\\",\\\"sceneId\\\":36,\\\"sceneName\\\":\\\"zScene117\\\",\\\"subType\\\":\\\"flowControl\\\",\\\"thirdBizType\\\":\\\"ad\\\",\\\"trafficAllocationType\\\":\\\"segment\\\",\\\"updateTime\\\":1573676346886,\\\"withThirdParty\\\":1}\",\"remark\":\"\"},{\"bizLineName\":\"ad\",\"changeType\":\"CHANGE_OF_VAR_PARAM\",\"createTime\":1574119335179,\"id\":286,\"layerCode\":\"zLayer116\",\"layerId\":28,\"layerName\":\"zLayer116\",\"operator\":\"张振威\",\"relatedKey\":\"zLayer116\",\"relatedVal\":\"{\\\"bizLineName\\\":\\\"ad\\\",\\\"createTime\\\":1573237303953,\\\"creator\\\":\\\"张振威\\\",\\\"description\\\":\\\"zLab119\\\",\\\"factor\\\":\\\"\\\",\\\"hashEncrypt\\\":1,\\\"hashSwitch\\\":1,\\\"id\\\":56,\\\"labName\\\":\\\"zLab119\\\",\\\"labState\\\":\\\"not_starting\\\",\\\"labType\\\":\\\"algorithm\\\",\\\"layerCode\\\":\\\"zLayer116\\\",\\\"layerId\\\":28,\\\"layerName\\\":\\\"zLayer116\\\",\\\"modifier\\\":\\\"张振威\\\",\\\"moduleCode\\\":\\\"ad-center\\\",\\\"moduleId\\\":4,\\\"moduleName\\\":\\\"广告\\\",\\\"relatedLayer\\\":1,\\\"sceneCode\\\":\\\"zScene117\\\",\\\"sceneId\\\":36,\\\"sceneName\\\":\\\"zScene117\\\",\\\"subType\\\":\\\"flowControl\\\",\\\"thirdBizType\\\":\\\"ad\\\",\\\"trafficAllocationType\\\":\\\"segment\\\",\\\"updateTime\\\":1573676346886,\\\"withThirdParty\\\":1}\",\"remark\":\"\"},{\"bizLineName\":\"ad\",\"changeType\":\"CHANGE_OF_LAUNCH\",\"createTime\":1573434389220,\"id\":285,\"layerCode\":\"code_asd\",\"layerId\":32,\"layerName\":\"前端测试111103\",\"operator\":\"张振威\",\"relatedKey\":\"code_asd\",\"relatedVal\":\"{\\\"approvalId\\\":-1,\\\"bizLineName\\\":\\\"ad\\\",\\\"creator\\\":\\\"张振威\\\",\\\"enable\\\":1,\\\"labVariableCode\\\":\\\"code5712\\\",\\\"labVariableName\\\":\\\"策略实验参数模板1\\\",\\\"launchState\\\":\\\"effective\\\",\\\"layerCode\\\":\\\"code_asd\\\",\\\"layerId\\\":32,\\\"layerName\\\":\\\"前端测试111103\\\",\\\"modifier\\\":\\\"\\\",\\\"trafficPositionIds\\\":\\\"[{\\\\\\\"relatedKey\\\\\\\":\\\\\\\"1\\\\\\\",\\\\\\\"relatedName\\\\\\\":\\\\\\\"广告位ID1\\\\\\\"}]\\\",\\\"trafficPositionType\\\":\\\"ad\\\",\\\"varParam\\\":\\\"{\\\\\\\"a\\\\\\\":\\\\\\\"f\\\\\\\",\\\\\\\"b\\\\\\\":\\\\\\\"f\\\\\\\"}\\\"}\",\"remark\":\"ADD\"},{\"bizLineName\":\"ad\",\"changeType\":\"CHANGE_OF_LAUNCH\",\"createTime\":1573434363048,\"id\":284,\"layerCode\":\"code_asd\",\"layerId\":32,\"layerName\":\"前端测试111103\",\"operator\":\"张振威\",\"relatedKey\":\"code_asd\",\"relatedVal\":\"{\\\"approvalId\\\":-1,\\\"bizLineName\\\":\\\"ad\\\",\\\"creator\\\":\\\"张振威\\\",\\\"enable\\\":1,\\\"labVariableCode\\\":\\\"codeAd12\\\",\\\"labVariableName\\\":\\\"广告参数模板测试默认值\\\",\\\"launchState\\\":\\\"effective\\\",\\\"layerCode\\\":\\\"code_asd\\\",\\\"layerId\\\":32,\\\"layerName\\\":\\\"前端测试111103\\\",\\\"modifier\\\":\\\"\\\",\\\"trafficPositionIds\\\":\\\"[{\\\\\\\"relatedKey\\\\\\\":\\\\\\\"1\\\\\\\",\\\\\\\"relatedName\\\\\\\":\\\\\\\"广告位ID1\\\\\\\"}]\\\",\\\"trafficPositionType\\\":\\\"ad\\\",\\\"varParam\\\":\\\"{\\\\\\\"a\\\\\\\":\\\\\\\"1\\\\\\\",\\\\\\\"b\\\\\\\":\\\\\\\"as\\\\\\\"}\\\"}\",\"remark\":\"ADD\"},{\"bizLineName\":\"ad\",\"changeType\":\"CHANGE_OF_LAUNCH\",\"createTime\":1573433638608,\"id\":283,\"layerCode\":\"code_asd\",\"layerId\":32,\"layerName\":\"前端测试111103\",\"operator\":\"张振威\",\"relatedKey\":\"code_asd\",\"relatedVal\":\"{\\\"approvalId\\\":-1,\\\"bizLineName\\\":\\\"ad\\\",\\\"creator\\\":\\\"张振威\\\",\\\"enable\\\":1,\\\"labVariableCode\\\":\\\"code75032\\\",\\\"labVariableName\\\":\\\"产品实验参数模板1\\\",\\\"launchState\\\":\\\"effective\\\",\\\"layerCode\\\":\\\"code_asd\\\",\\\"layerId\\\":32,\\\"layerName\\\":\\\"前端测试111103\\\",\\\"modifier\\\":\\\"\\\",\\\"trafficPositionIds\\\":\\\"[{\\\\\\\"relatedKey\\\\\\\":\\\\\\\"36\\\\\\\",\\\\\\\"relatedName\\\\\\\":\\\\\\\"zScene117\\\\\\\"}]\\\",\\\"trafficPositionType\\\":\\\"scene\\\",\\\"varParam\\\":\\\"{\\\\\\\"a\\\\\\\":\\\\\\\"1\\\\\\\",\\\\\\\"b\\\\\\\":\\\\\\\"1\\\\\\\"}\\\"}\",\"remark\":\"ADD\"},{\"bizLineName\":\"ad\",\"changeType\":\"CHANGE_OF_LAYER\",\"createTime\":1573426761786,\"id\":282,\"layerCode\":\"code_asd\",\"layerId\":32,\"layerName\":\"前端测试111103\",\"operator\":\"李冕\",\"relatedKey\":\"code_asd\",\"relatedVal\":\"{\\\"bizLineName\\\":\\\"ad\\\",\\\"code\\\":\\\"code_asd\\\",\\\"creator\\\":\\\"李冕\\\",\\\"encryptSwitch\\\":1,\\\"hashSwitch\\\":1,\\\"id\\\":32,\\\"modifier\\\":\\\"\\\",\\\"name\\\":\\\"前端测试111103\\\",\\\"salt\\\":\\\"abc\\\",\\\"saltLocation\\\":1,\\\"saltSwitch\\\":1,\\\"shuntField\\\":\\\"IMEI\\\"}\",\"remark\":\"add\"},{\"bizLineName\":\"ad\",\"changeType\":\"CHANGE_OF_LAYER\",\"createTime\":1573425919830,\"id\":281,\"layerCode\":\"code_asdg\",\"layerId\":31,\"layerName\":\"前端测试111102\",\"operator\":\"李冕\",\"relatedKey\":\"code_asdg\",\"relatedVal\":\"{\\\"bizLineName\\\":\\\"ad\\\",\\\"code\\\":\\\"code_asdg\\\",\\\"creator\\\":\\\"李冕\\\",\\\"encryptSwitch\\\":1,\\\"hashSwitch\\\":1,\\\"id\\\":31,\\\"modifier\\\":\\\"\\\",\\\"name\\\":\\\"前端测试111102\\\",\\\"salt\\\":\\\"abc\\\",\\\"saltLocation\\\":1,\\\"saltSwitch\\\":1,\\\"shuntField\\\":\\\"IMEI\\\"}\",\"remark\":\"add\"},{\"bizLineName\":\"ad\",\"changeType\":\"CHANGE_OF_LAYER\",\"createTime\":1573425805623,\"id\":280,\"layerCode\":\"code_asdf\",\"layerId\":30,\"layerName\":\"前端测试111101\",\"operator\":\"李冕\",\"relatedKey\":\"code_asdf\",\"relatedVal\":\"{\\\"bizLineName\\\":\\\"ad\\\",\\\"code\\\":\\\"code_asdf\\\",\\\"creator\\\":\\\"李冕\\\",\\\"encryptSwitch\\\":1,\\\"hashSwitch\\\":1,\\\"id\\\":30,\\\"modifier\\\":\\\"\\\",\\\"name\\\":\\\"前端测试111101\\\",\\\"salt\\\":\\\"abc\\\",\\\"saltLocation\\\":1,\\\"saltSwitch\\\":1,\\\"shuntField\\\":\\\"IMEI\\\"}\",\"remark\":\"add\"}],\"fetchType\":\"INCREMENT\"}";
    std::shared_ptr<VepApiLayerFetchVo> vepApiLayerFetchVo = std::make_shared<VepApiLayerFetchVo>();
    VepDeserializeUtils::DeserializeVepApiLayerFetchVo(json_str, vepApiLayerFetchVo);

    EXPECT_EQ("INCREMENT", vepApiLayerFetchVo->fetch_type);

    EXPECT_EQ(15, (int)(vepApiLayerFetchVo->change_list.size()));
    EXPECT_EQ(1574791574601, (long)(vepApiLayerFetchVo->change_list[0]->create_time));
    EXPECT_EQ("pCTR层1", vepApiLayerFetchVo->change_list[0]->layer_name);
}

TEST(VepDeserializeUtils, DeserializeVepApiLaunchLayerVo){
    std::string json_str = "{\"layerCode\":\"predict_1107\",\"launchLayerList\":[{\"id\":44,\"layerId\":29,\"trafficPositionType\":\"ad\",\"trafficPositionIds\":\"[{\\\"relatedKey\\\":\\\"1\\\",\\\"relatedName\\\":\\\"广告位ID1\\\"},{\\\"relatedKey\\\":\\\"2\\\",\\\"relatedName\\\":\\\"广告位ID2\\\"},{\\\"relatedKey\\\":\\\"3\\\",\\\"relatedName\\\":\\\"广告位ID3\\\"}]\",\"labVariableName\":\"广告pctr模型01\",\"labVariableCode\":\"ad-pctr-model-01\",\"varParam\":\"{\\\"pctr\\\":\\\"4.1\\\",\\\"ds\\\":\\\"4.1\\\"}\",\"launchState\":\"effective\",\"enable\":1,\"creator\":\"林承君\",\"modifier\":\"林承君\",\"createTime\":1573072295349,\"updateTime\":1573072321838,\"approvalId\":-1}],\"lastLayerChangingTime\":1574480627429}";
    std::shared_ptr<VepApiLaunchLayerVo> launch_layer_vo = std::make_shared<VepApiLaunchLayerVo>();
    VepDeserializeUtils::DeserializeVepApiLaunchLayerVo(json_str, launch_layer_vo);

    EXPECT_EQ("predict_1107", launch_layer_vo->layer_code);
    EXPECT_EQ(1, (int)(launch_layer_vo->launch_layer_list.size()));
    EXPECT_EQ(1574480627429, (long)(launch_layer_vo->last_layer_changing_time));

    EXPECT_EQ("{\"pctr\":\"4.1\",\"ds\":\"4.1\"}", launch_layer_vo->launch_layer_list[0]->var_param);
}

TEST(VepDeserializeUtils, DeserializeThirdRelatedPositionParam){
    std::string json_str = "[{\"relatedKey\":\"1\",\"relatedName\":\"广告位ID1\"},{\"relatedKey\":\"2\",\"relatedName\":\"广告位ID2\"},{\"relatedKey\":\"3\",\"relatedName\":\"广告位ID3\"}]";
    std::vector<std::shared_ptr<ThirdRelatedPositionParam>> thirdRelatedPositionParams;
    VepDeserializeUtils::DeserializeThirdRelatedPositionParam(json_str, &thirdRelatedPositionParams);

    EXPECT_EQ(3, (int)(thirdRelatedPositionParams.size()));

    EXPECT_EQ("1", thirdRelatedPositionParams[0]->related_key);
    EXPECT_EQ("广告位ID1", thirdRelatedPositionParams[0]->related_name);
    EXPECT_EQ("3", thirdRelatedPositionParams[2]->related_key);
    EXPECT_EQ("广告位ID3", thirdRelatedPositionParams[2]->related_name);
}

TEST(VepDeserializeUtils, DeserializeMap){
    std::string json_str = "{\"100\":125,\"101\":126}";
    std::unordered_map<std::string, int> params = VepDeserializeUtils::DeserializeMap(json_str);

    EXPECT_EQ(2, (int)(params.size()));
    EXPECT_EQ(125, params["100"]);
    EXPECT_EQ(126, params["101"]);
}

TEST(VepDeserializeUtils, DeserializeVepApiLabVo){
    std::string json_str = "{\"lab\":{\"id\":54,\"labName\":\"lab-1106\",\"description\":\"\",\"factor\":\"12345678abc\",\"labState\":\"effective\",\"labType\":\"algorithm\",\"moduleId\":12,\"sceneId\":38,\"sceneCode\":\"scene_1106\",\"trafficAllocationType\":\"segment\",\"bizLineName\":\"ad\",\"createTime\":1573089971811,\"updateTime\":1574903650518,\"creator\":\"林承君\",\"modifier\":\"张振威\",\"hashEncrypt\":1,\"hashSwitch\":1,\"subType\":\"flowControl\",\"relatedLayer\":0,\"layerId\":-1,\"shuntField\":\"IMEI\",\"shuntTagType\":\"\",\"saltSwitch\":1,\"saltLocation\":1},\"hashMatchLength\":3,\"whitelistMap\":{},\"segmentMap\":{\"100\":125,\"101\":126,\"102\":125,\"103\":125,\"104\":125,\"105\":125,\"106\":125,\"107\":125,\"108\":125,\"109\":125,\"110\":125,\"111\":126,\"112\":125,\"113\":125,\"114\":125,\"115\":125,\"116\":125,\"117\":125,\"118\":125,\"119\":125,\"120\":125,\"121\":126,\"122\":125,\"123\":125,\"124\":125,\"125\":125,\"126\":125,\"127\":125,\"128\":125,\"129\":125,\"130\":125,\"131\":126,\"132\":125,\"133\":125,\"134\":125,\"135\":125,\"136\":125,\"137\":125,\"138\":125,\"139\":125,\"140\":125,\"141\":126,\"142\":125,\"143\":125,\"144\":125,\"145\":125,\"146\":125,\"147\":125,\"148\":125,\"149\":125,\"150\":125,\"151\":126,\"152\":125,\"153\":125,\"154\":125,\"155\":125,\"156\":125,\"157\":125,\"158\":125,\"159\":125,\"160\":125,\"161\":126,\"162\":125,\"163\":125,\"164\":125,\"165\":125,\"166\":125,\"167\":125,\"168\":125,\"169\":125,\"170\":125,\"171\":126,\"172\":125,\"173\":125,\"174\":125,\"175\":125,\"176\":125,\"177\":125,\"178\":125,\"179\":125,\"180\":125,\"181\":126,\"182\":125,\"183\":125,\"184\":125,\"185\":125,\"186\":125,\"187\":125,\"188\":125,\"189\":125,\"190\":125,\"191\":126,\"192\":125,\"193\":125,\"194\":125,\"195\":125,\"196\":125,\"197\":125,\"198\":125,\"199\":125,\"200\":125,\"201\":126,\"202\":125,\"203\":125,\"204\":125,\"205\":125,\"206\":125,\"207\":125,\"208\":125,\"209\":125,\"210\":125,\"211\":126,\"212\":125,\"213\":125,\"214\":125,\"215\":125,\"216\":125,\"217\":125,\"218\":125,\"219\":125,\"220\":125,\"221\":126,\"222\":125,\"223\":125,\"224\":125,\"225\":125,\"226\":125,\"227\":125,\"228\":125,\"229\":125,\"230\":125,\"231\":126,\"232\":125,\"233\":125,\"234\":125,\"235\":125,\"236\":125,\"237\":125,\"238\":125,\"239\":125,\"240\":125,\"241\":126,\"242\":125,\"243\":125,\"244\":125,\"245\":125,\"246\":125,\"247\":125,\"248\":125,\"249\":125,\"250\":125,\"251\":126,\"252\":125,\"253\":125,\"254\":125,\"255\":125,\"256\":125,\"257\":125,\"258\":125,\"259\":125,\"260\":125,\"261\":126,\"262\":125,\"263\":125,\"264\":125,\"265\":125,\"266\":125,\"267\":125,\"268\":125,\"269\":125,\"270\":125,\"271\":126,\"272\":125,\"273\":125,\"274\":125,\"275\":125,\"276\":125,\"277\":125,\"278\":125,\"279\":125,\"280\":125,\"281\":126,\"282\":125,\"283\":125,\"284\":125,\"285\":125,\"286\":125,\"287\":125,\"288\":125,\"289\":125,\"290\":125,\"291\":126,\"292\":125,\"293\":125,\"294\":125,\"295\":125,\"296\":125,\"297\":125,\"298\":125,\"299\":125,\"300\":125,\"301\":126,\"302\":125,\"303\":125,\"304\":125,\"305\":125,\"306\":125,\"307\":125,\"308\":125,\"309\":125,\"310\":125,\"311\":126,\"312\":125,\"313\":125,\"314\":125,\"315\":125,\"316\":125,\"317\":125,\"318\":125,\"319\":125,\"320\":125,\"321\":126,\"322\":125,\"323\":125,\"324\":125,\"325\":125,\"326\":125,\"327\":125,\"328\":125,\"329\":125,\"330\":125,\"331\":126,\"332\":125,\"333\":125,\"334\":125,\"335\":125,\"336\":125,\"337\":125,\"338\":125,\"339\":125,\"340\":125,\"341\":126,\"342\":125,\"343\":125,\"344\":125,\"345\":125,\"346\":125,\"347\":125,\"348\":125,\"349\":125,\"350\":125,\"351\":126,\"352\":125,\"353\":125,\"354\":125,\"355\":125,\"356\":125,\"357\":125,\"358\":125,\"359\":125,\"360\":125,\"361\":126,\"362\":125,\"363\":125,\"364\":125,\"365\":125,\"366\":125,\"367\":125,\"368\":125,\"369\":125,\"370\":125,\"371\":126,\"372\":125,\"373\":125,\"374\":125,\"375\":125,\"376\":125,\"377\":125,\"378\":125,\"379\":125,\"380\":125,\"381\":126,\"382\":125,\"383\":125,\"384\":125,\"385\":125,\"386\":125,\"387\":125,\"388\":125,\"389\":125,\"390\":125,\"391\":126,\"392\":125,\"393\":125,\"394\":125,\"395\":125,\"396\":125,\"397\":125,\"398\":125,\"399\":125,\"400\":125,\"401\":126,\"402\":125,\"403\":125,\"404\":125,\"405\":125,\"406\":125,\"407\":125,\"408\":125,\"409\":125,\"410\":125,\"411\":126,\"412\":125,\"413\":125,\"414\":125,\"415\":125,\"416\":125,\"417\":125,\"418\":125,\"419\":125,\"420\":125,\"421\":126,\"422\":125,\"423\":125,\"424\":125,\"425\":125,\"426\":125,\"427\":125,\"428\":125,\"429\":125,\"430\":125,\"431\":126,\"432\":125,\"433\":125,\"434\":125,\"435\":125,\"436\":125,\"437\":125,\"438\":125,\"439\":125,\"440\":125,\"441\":126,\"442\":125,\"443\":125,\"444\":125,\"445\":125,\"446\":125,\"447\":125,\"448\":125,\"449\":125,\"450\":125,\"451\":126,\"452\":125,\"453\":125,\"454\":125,\"455\":125,\"456\":125,\"457\":125,\"458\":125,\"459\":125,\"460\":125,\"461\":126,\"462\":125,\"463\":125,\"464\":125,\"465\":125,\"466\":125,\"467\":125,\"468\":125,\"469\":125,\"470\":125,\"471\":126,\"472\":125,\"473\":125,\"474\":125,\"475\":125,\"476\":125,\"477\":125,\"478\":125,\"479\":125,\"480\":125,\"481\":126,\"482\":125,\"483\":125,\"484\":125,\"485\":125,\"486\":125,\"487\":125,\"488\":125,\"489\":125,\"490\":125,\"491\":126,\"492\":125,\"493\":125,\"494\":125,\"495\":125,\"496\":125,\"497\":125,\"498\":125,\"499\":125,\"500\":125,\"501\":126,\"502\":125,\"503\":125,\"504\":125,\"505\":125,\"506\":125,\"507\":125,\"508\":125,\"509\":125,\"510\":125,\"511\":126,\"512\":125,\"513\":125,\"514\":125,\"515\":125,\"516\":125,\"517\":125,\"518\":125,\"519\":125,\"520\":125,\"521\":126,\"522\":125,\"523\":125,\"524\":125,\"525\":125,\"526\":125,\"527\":125,\"528\":125,\"529\":125,\"530\":125,\"531\":126,\"532\":125,\"533\":125,\"534\":125,\"535\":125,\"536\":125,\"537\":125,\"538\":125,\"539\":125,\"540\":125,\"541\":126,\"542\":125,\"543\":125,\"544\":125,\"545\":125,\"546\":125,\"547\":125,\"548\":125,\"549\":125,\"550\":125,\"551\":126,\"552\":125,\"553\":125,\"554\":125,\"555\":125,\"556\":125,\"557\":125,\"558\":125,\"559\":125,\"560\":125,\"561\":126,\"562\":125,\"563\":125,\"564\":125,\"565\":125,\"566\":125,\"567\":125,\"568\":125,\"569\":125,\"570\":125,\"571\":126,\"572\":125,\"573\":125,\"574\":125,\"575\":125,\"576\":125,\"577\":125,\"578\":125,\"579\":125,\"580\":125,\"581\":126,\"582\":125,\"583\":125,\"584\":125,\"585\":125,\"586\":125,\"587\":125,\"588\":125,\"589\":125,\"590\":125,\"591\":126,\"592\":125,\"593\":125,\"594\":125,\"595\":125,\"596\":125,\"597\":125,\"598\":125,\"599\":125,\"600\":125,\"601\":126,\"602\":125,\"603\":125,\"604\":125,\"605\":125,\"606\":125,\"607\":125,\"608\":125,\"609\":125,\"610\":125,\"611\":126,\"612\":125,\"613\":125,\"614\":125,\"615\":125,\"616\":125,\"617\":125,\"618\":125,\"619\":125,\"620\":125,\"621\":126,\"622\":125,\"623\":125,\"624\":125,\"625\":125,\"626\":125,\"627\":125,\"628\":125,\"629\":125,\"630\":125,\"631\":126,\"632\":125,\"633\":125,\"634\":125,\"635\":125,\"636\":125,\"637\":125,\"638\":125,\"639\":125,\"640\":125,\"641\":126,\"642\":125,\"643\":125,\"644\":125,\"645\":125,\"646\":125,\"647\":125,\"648\":125,\"649\":125,\"650\":125,\"651\":126,\"652\":125,\"653\":125,\"654\":125,\"655\":125,\"656\":125,\"657\":125,\"658\":125,\"659\":125,\"660\":125,\"661\":126,\"662\":125,\"663\":125,\"664\":125,\"665\":125,\"666\":125,\"667\":125,\"668\":125,\"669\":125,\"670\":125,\"671\":126,\"672\":125,\"673\":125,\"674\":125,\"675\":125,\"676\":125,\"677\":125,\"678\":125,\"679\":125,\"680\":125,\"681\":126,\"682\":125,\"683\":125,\"684\":125,\"685\":125,\"686\":125,\"687\":125,\"688\":125,\"689\":125,\"690\":125,\"691\":126,\"692\":125,\"693\":125,\"694\":125,\"695\":125,\"696\":125,\"697\":125,\"698\":125,\"699\":125,\"700\":125,\"701\":126,\"702\":125,\"703\":125,\"704\":125,\"705\":125,\"706\":125,\"707\":125,\"708\":125,\"709\":125,\"710\":125,\"711\":126,\"712\":125,\"713\":125,\"714\":125,\"715\":125,\"716\":125,\"717\":125,\"718\":125,\"719\":125,\"720\":125,\"721\":126,\"722\":125,\"723\":125,\"724\":125,\"725\":125,\"726\":125,\"727\":125,\"728\":125,\"729\":125,\"730\":125,\"731\":126,\"732\":125,\"733\":125,\"734\":125,\"735\":125,\"736\":125,\"737\":125,\"738\":125,\"739\":125,\"740\":125,\"741\":126,\"742\":125,\"743\":125,\"744\":125,\"745\":125,\"746\":125,\"747\":125,\"748\":125,\"749\":125,\"750\":125,\"751\":126,\"752\":125,\"753\":125,\"754\":125,\"755\":125,\"756\":125,\"757\":125,\"758\":125,\"759\":125,\"760\":125,\"761\":126,\"762\":125,\"763\":125,\"764\":125,\"765\":125,\"766\":125,\"767\":125,\"768\":125,\"769\":125,\"770\":125,\"771\":126,\"772\":125,\"773\":125,\"774\":125,\"775\":125,\"776\":125,\"777\":125,\"778\":125,\"779\":125,\"780\":125,\"781\":126,\"782\":125,\"783\":125,\"784\":125,\"785\":125,\"786\":125,\"787\":125,\"788\":125,\"789\":125,\"790\":125,\"791\":126,\"792\":125,\"793\":125,\"794\":125,\"795\":125,\"796\":125,\"797\":125,\"798\":125,\"799\":125,\"800\":125,\"801\":126,\"802\":125,\"803\":125,\"804\":125,\"805\":125,\"806\":125,\"807\":125,\"808\":125,\"809\":125,\"810\":125,\"811\":126,\"812\":125,\"813\":125,\"814\":125,\"815\":125,\"816\":125,\"817\":125,\"818\":125,\"819\":125,\"820\":125,\"821\":126,\"822\":125,\"823\":125,\"824\":125,\"825\":125,\"826\":125,\"827\":125,\"828\":125,\"829\":125,\"830\":125,\"831\":126,\"832\":125,\"833\":125,\"834\":125,\"835\":125,\"836\":125,\"837\":125,\"838\":125,\"839\":125,\"840\":125,\"841\":126,\"842\":125,\"843\":125,\"844\":125,\"845\":125,\"846\":125,\"847\":125,\"848\":125,\"849\":125,\"850\":125,\"851\":126,\"852\":125,\"853\":125,\"854\":125,\"855\":125,\"856\":125,\"857\":125,\"858\":125,\"859\":125,\"860\":125,\"861\":126,\"862\":125,\"863\":125,\"864\":125,\"865\":125,\"866\":125,\"867\":125,\"868\":125,\"869\":125,\"870\":125,\"871\":126,\"872\":125,\"873\":125,\"874\":125,\"875\":125,\"876\":125,\"877\":125,\"878\":125,\"879\":125,\"880\":125,\"881\":126,\"882\":125,\"883\":125,\"884\":125,\"885\":125,\"886\":125,\"887\":125,\"888\":125,\"889\":125,\"890\":125,\"891\":126,\"892\":125,\"893\":125,\"894\":125,\"895\":125,\"896\":125,\"897\":125,\"898\":125,\"899\":125,\"900\":125,\"901\":126,\"902\":125,\"903\":125,\"904\":125,\"905\":125,\"906\":125,\"907\":125,\"908\":125,\"909\":125,\"910\":125,\"911\":126,\"912\":125,\"913\":125,\"914\":125,\"915\":125,\"916\":125,\"917\":125,\"918\":125,\"919\":125,\"920\":125,\"921\":126,\"922\":125,\"923\":125,\"924\":125,\"925\":125,\"926\":125,\"927\":125,\"928\":125,\"929\":125,\"930\":125,\"931\":126,\"932\":125,\"933\":125,\"934\":125,\"935\":125,\"936\":125,\"937\":125,\"938\":125,\"939\":125,\"940\":125,\"941\":126,\"942\":125,\"943\":125,\"944\":125,\"945\":125,\"946\":125,\"947\":125,\"948\":125,\"949\":125,\"950\":125,\"951\":126,\"952\":125,\"953\":125,\"954\":125,\"955\":125,\"956\":125,\"957\":125,\"958\":125,\"959\":125,\"960\":125,\"961\":126,\"962\":125,\"963\":125,\"964\":125,\"965\":125,\"966\":125,\"967\":125,\"968\":125,\"969\":125,\"970\":125,\"971\":126,\"972\":125,\"973\":125,\"974\":125,\"975\":125,\"976\":125,\"977\":125,\"978\":125,\"979\":125,\"980\":125,\"981\":126,\"982\":125,\"983\":125,\"984\":125,\"985\":125,\"986\":125,\"987\":125,\"988\":125,\"989\":125,\"990\":125,\"991\":126,\"992\":125,\"993\":125,\"994\":125,\"995\":125,\"996\":125,\"997\":125,\"998\":125,\"999\":125,\"000\":125,\"001\":126,\"002\":125,\"003\":125,\"004\":125,\"005\":125,\"006\":125,\"007\":125,\"008\":125,\"009\":125,\"010\":125,\"011\":126,\"012\":125,\"013\":125,\"014\":125,\"015\":125,\"016\":125,\"017\":125,\"018\":125,\"019\":125,\"020\":125,\"021\":126,\"022\":125,\"023\":125,\"024\":125,\"025\":125,\"026\":125,\"027\":125,\"028\":125,\"029\":125,\"030\":125,\"031\":126,\"032\":125,\"033\":125,\"034\":125,\"035\":125,\"036\":125,\"037\":125,\"038\":125,\"039\":125,\"040\":125,\"041\":126,\"042\":125,\"043\":125,\"044\":125,\"045\":125,\"046\":125,\"047\":125,\"048\":125,\"049\":125,\"050\":125,\"051\":126,\"052\":125,\"053\":125,\"054\":125,\"055\":125,\"056\":125,\"057\":125,\"058\":125,\"059\":125,\"060\":125,\"061\":126,\"062\":125,\"063\":125,\"064\":125,\"065\":125,\"066\":125,\"067\":125,\"068\":125,\"069\":125,\"070\":125,\"071\":126,\"072\":125,\"073\":125,\"074\":125,\"075\":125,\"076\":125,\"077\":125,\"078\":125,\"079\":125,\"080\":125,\"081\":126,\"082\":125,\"083\":125,\"084\":125,\"085\":125,\"086\":125,\"087\":125,\"088\":125,\"089\":125,\"090\":125,\"091\":126,\"092\":125,\"093\":125,\"094\":125,\"095\":125,\"096\":125,\"097\":125,\"098\":125,\"099\":125},\"versionIdList\":[125,126],\"versionMap\":{\"125\":{\"id\":125,\"labId\":54,\"versionName\":\"v1\",\"description\":\"\",\"whitelist\":\"\",\"baselineState\":0,\"integrationState\":\"test_succeed\",\"labVariableName\":\"广告pctr模型01\",\"labVariableCode\":\"ad-pctr-model-01\",\"diversionType\":\"hash_imei\",\"diversionStrategy\":\"0,2,3,4,5,6,7,8,9\",\"trafficRatio\":900,\"interventionStrategy\":\"\",\"shuntTagStrategy\":\"\",\"createTime\":1573089983000,\"updateTime\":1573090420564,\"params\":{\"pctr\":1,\"ds\":\"1\"},\"creator\":\"林承君\",\"modifier\":\"林承君\"},\"126\":{\"id\":126,\"labId\":54,\"versionName\":\"v2\",\"description\":\"\",\"whitelist\":\"\",\"baselineState\":1,\"integrationState\":\"test_succeed\",\"labVariableName\":\"广告pctr模型01\",\"labVariableCode\":\"ad-pctr-model-01\",\"diversionType\":\"hash_imei\",\"diversionStrategy\":\"1\",\"trafficRatio\":100,\"interventionStrategy\":\"\",\"shuntTagStrategy\":\"\",\"createTime\":1573090086000,\"updateTime\":1573090420564,\"params\":{\"pctr\":2,\"ds\":\"2\"},\"creator\":\"林承君\",\"modifier\":\"林承君\"}}}";

    std::shared_ptr<VepApiLabVo> lab_vo = std::make_shared<VepApiLabVo>();
    VepDeserializeUtils::DeserializeVepApiLabVo(json_str, lab_vo);
    //lab
    EXPECT_EQ(54, lab_vo->lab.id);
    EXPECT_EQ("scene_1106", lab_vo->lab.scene_code);
    //hashMatchLength
    EXPECT_EQ(3, lab_vo->hash_match_length);
    //whitelistMap
    EXPECT_EQ(0, (int)(lab_vo->whitelist_map.size()));
    //segmentMap
    EXPECT_EQ(125, lab_vo->segment_map["100"]);
    //versionIdList
    EXPECT_EQ(2, (int)(lab_vo->version_id_list.size()));
    //versionMap
    EXPECT_EQ(2, (int)(lab_vo->version_map.size()));

    std::shared_ptr<LabVersionDto> &lab_version_dto = lab_vo->version_map[125];  //取出vector中的第一个
    EXPECT_EQ(125, lab_version_dto->id);
    EXPECT_EQ("广告pctr模型01", lab_version_dto->lab_variable_name);
    EXPECT_EQ(1573089983000, (long)(lab_version_dto->create_time));
    EXPECT_EQ(2, (int)(lab_version_dto->params.size()));

    EXPECT_EQ("1", lab_version_dto->params["ds"]);
    EXPECT_EQ("1", lab_version_dto->params["pctr"]);
}

TEST(VepDeserializeUtils, DeserializeVepApiSceneVo){
    std::string json_str = "{\"scene\":{\"id\":38,\"moduleId\":12,\"name\":\"scene_1106\",\"code\":\"scene_1106\",\"state\":0,\"createTime\":1573089936769,\"firstChar\":\"s\",\"creator\":\"林承君\",\"modifier\":\"\",\"updateTime\":1573089936769,\"withThirdParty\":0,\"thirdBizType\":\"\",\"moduleCode\":\"ad_1107\",\"moduleName\":\"广告1107\",\"related_list\":null},\"labNameList\":[\"lab-1106\",\"前端测试120401\"],\"labMap\":{\"lab-1106\":{\"lab\":{\"id\":54,\"labName\":\"lab-1106\",\"description\":\"\",\"factor\":\"12345678abc\",\"labState\":\"effective\",\"labType\":\"algorithm\",\"moduleId\":12,\"sceneId\":38,\"sceneCode\":\"scene_1106\",\"trafficAllocationType\":\"segment\",\"bizLineName\":\"ad\",\"createTime\":1573089971811,\"updateTime\":1574903650518,\"creator\":\"林承君\",\"modifier\":\"张振威\",\"hashEncrypt\":1,\"hashSwitch\":1,\"subType\":\"flowControl\",\"relatedLayer\":0,\"layerId\":-1,\"shuntField\":\"IMEI\",\"shuntTagType\":\"\",\"saltSwitch\":1,\"saltLocation\":1},\"hashMatchLength\":3,\"whitelistMap\":{},\"segmentMap\":{\"100\":125,\"101\":126,\"102\":125,\"103\":125,\"104\":125,\"105\":125,\"106\":125,\"107\":125,\"108\":125,\"109\":125,\"110\":125,\"111\":126,\"112\":125,\"113\":125,\"114\":125,\"115\":125,\"116\":125,\"117\":125,\"118\":125,\"119\":125,\"120\":125,\"121\":126,\"122\":125,\"123\":125,\"124\":125,\"125\":125,\"126\":125,\"127\":125,\"128\":125,\"129\":125,\"130\":125,\"131\":126,\"132\":125,\"133\":125,\"134\":125,\"135\":125,\"136\":125,\"137\":125,\"138\":125,\"139\":125,\"140\":125,\"141\":126,\"142\":125,\"143\":125,\"144\":125,\"145\":125,\"146\":125,\"147\":125,\"148\":125,\"149\":125,\"150\":125,\"151\":126,\"152\":125,\"153\":125,\"154\":125,\"155\":125,\"156\":125,\"157\":125,\"158\":125,\"159\":125,\"160\":125,\"161\":126,\"162\":125,\"163\":125,\"164\":125,\"165\":125,\"166\":125,\"167\":125,\"168\":125,\"169\":125,\"170\":125,\"171\":126,\"172\":125,\"173\":125,\"174\":125,\"175\":125,\"176\":125,\"177\":125,\"178\":125,\"179\":125,\"180\":125,\"181\":126,\"182\":125,\"183\":125,\"184\":125,\"185\":125,\"186\":125,\"187\":125,\"188\":125,\"189\":125,\"190\":125,\"191\":126,\"192\":125,\"193\":125,\"194\":125,\"195\":125,\"196\":125,\"197\":125,\"198\":125,\"199\":125,\"200\":125,\"201\":126,\"202\":125,\"203\":125,\"204\":125,\"205\":125,\"206\":125,\"207\":125,\"208\":125,\"209\":125,\"210\":125,\"211\":126,\"212\":125,\"213\":125,\"214\":125,\"215\":125,\"216\":125,\"217\":125,\"218\":125,\"219\":125,\"220\":125,\"221\":126,\"222\":125,\"223\":125,\"224\":125,\"225\":125,\"226\":125,\"227\":125,\"228\":125,\"229\":125,\"230\":125,\"231\":126,\"232\":125,\"233\":125,\"234\":125,\"235\":125,\"236\":125,\"237\":125,\"238\":125,\"239\":125,\"240\":125,\"241\":126,\"242\":125,\"243\":125,\"244\":125,\"245\":125,\"246\":125,\"247\":125,\"248\":125,\"249\":125,\"250\":125,\"251\":126,\"252\":125,\"253\":125,\"254\":125,\"255\":125,\"256\":125,\"257\":125,\"258\":125,\"259\":125,\"260\":125,\"261\":126,\"262\":125,\"263\":125,\"264\":125,\"265\":125,\"266\":125,\"267\":125,\"268\":125,\"269\":125,\"270\":125,\"271\":126,\"272\":125,\"273\":125,\"274\":125,\"275\":125,\"276\":125,\"277\":125,\"278\":125,\"279\":125,\"280\":125,\"281\":126,\"282\":125,\"283\":125,\"284\":125,\"285\":125,\"286\":125,\"287\":125,\"288\":125,\"289\":125,\"290\":125,\"291\":126,\"292\":125,\"293\":125,\"294\":125,\"295\":125,\"296\":125,\"297\":125,\"298\":125,\"299\":125,\"300\":125,\"301\":126,\"302\":125,\"303\":125,\"304\":125,\"305\":125,\"306\":125,\"307\":125,\"308\":125,\"309\":125,\"310\":125,\"311\":126,\"312\":125,\"313\":125,\"314\":125,\"315\":125,\"316\":125,\"317\":125,\"318\":125,\"319\":125,\"320\":125,\"321\":126,\"322\":125,\"323\":125,\"324\":125,\"325\":125,\"326\":125,\"327\":125,\"328\":125,\"329\":125,\"330\":125,\"331\":126,\"332\":125,\"333\":125,\"334\":125,\"335\":125,\"336\":125,\"337\":125,\"338\":125,\"339\":125,\"340\":125,\"341\":126,\"342\":125,\"343\":125,\"344\":125,\"345\":125,\"346\":125,\"347\":125,\"348\":125,\"349\":125,\"350\":125,\"351\":126,\"352\":125,\"353\":125,\"354\":125,\"355\":125,\"356\":125,\"357\":125,\"358\":125,\"359\":125,\"360\":125,\"361\":126,\"362\":125,\"363\":125,\"364\":125,\"365\":125,\"366\":125,\"367\":125,\"368\":125,\"369\":125,\"370\":125,\"371\":126,\"372\":125,\"373\":125,\"374\":125,\"375\":125,\"376\":125,\"377\":125,\"378\":125,\"379\":125,\"380\":125,\"381\":126,\"382\":125,\"383\":125,\"384\":125,\"385\":125,\"386\":125,\"387\":125,\"388\":125,\"389\":125,\"390\":125,\"391\":126,\"392\":125,\"393\":125,\"394\":125,\"395\":125,\"396\":125,\"397\":125,\"398\":125,\"399\":125,\"400\":125,\"401\":126,\"402\":125,\"403\":125,\"404\":125,\"405\":125,\"406\":125,\"407\":125,\"408\":125,\"409\":125,\"410\":125,\"411\":126,\"412\":125,\"413\":125,\"414\":125,\"415\":125,\"416\":125,\"417\":125,\"418\":125,\"419\":125,\"420\":125,\"421\":126,\"422\":125,\"423\":125,\"424\":125,\"425\":125,\"426\":125,\"427\":125,\"428\":125,\"429\":125,\"430\":125,\"431\":126,\"432\":125,\"433\":125,\"434\":125,\"435\":125,\"436\":125,\"437\":125,\"438\":125,\"439\":125,\"440\":125,\"441\":126,\"442\":125,\"443\":125,\"444\":125,\"445\":125,\"446\":125,\"447\":125,\"448\":125,\"449\":125,\"450\":125,\"451\":126,\"452\":125,\"453\":125,\"454\":125,\"455\":125,\"456\":125,\"457\":125,\"458\":125,\"459\":125,\"460\":125,\"461\":126,\"462\":125,\"463\":125,\"464\":125,\"465\":125,\"466\":125,\"467\":125,\"468\":125,\"469\":125,\"470\":125,\"471\":126,\"472\":125,\"473\":125,\"474\":125,\"475\":125,\"476\":125,\"477\":125,\"478\":125,\"479\":125,\"480\":125,\"481\":126,\"482\":125,\"483\":125,\"484\":125,\"485\":125,\"486\":125,\"487\":125,\"488\":125,\"489\":125,\"490\":125,\"491\":126,\"492\":125,\"493\":125,\"494\":125,\"495\":125,\"496\":125,\"497\":125,\"498\":125,\"499\":125,\"500\":125,\"501\":126,\"502\":125,\"503\":125,\"504\":125,\"505\":125,\"506\":125,\"507\":125,\"508\":125,\"509\":125,\"510\":125,\"511\":126,\"512\":125,\"513\":125,\"514\":125,\"515\":125,\"516\":125,\"517\":125,\"518\":125,\"519\":125,\"520\":125,\"521\":126,\"522\":125,\"523\":125,\"524\":125,\"525\":125,\"526\":125,\"527\":125,\"528\":125,\"529\":125,\"530\":125,\"531\":126,\"532\":125,\"533\":125,\"534\":125,\"535\":125,\"536\":125,\"537\":125,\"538\":125,\"539\":125,\"540\":125,\"541\":126,\"542\":125,\"543\":125,\"544\":125,\"545\":125,\"546\":125,\"547\":125,\"548\":125,\"549\":125,\"550\":125,\"551\":126,\"552\":125,\"553\":125,\"554\":125,\"555\":125,\"556\":125,\"557\":125,\"558\":125,\"559\":125,\"560\":125,\"561\":126,\"562\":125,\"563\":125,\"564\":125,\"565\":125,\"566\":125,\"567\":125,\"568\":125,\"569\":125,\"570\":125,\"571\":126,\"572\":125,\"573\":125,\"574\":125,\"575\":125,\"576\":125,\"577\":125,\"578\":125,\"579\":125,\"580\":125,\"581\":126,\"582\":125,\"583\":125,\"584\":125,\"585\":125,\"586\":125,\"587\":125,\"588\":125,\"589\":125,\"590\":125,\"591\":126,\"592\":125,\"593\":125,\"594\":125,\"595\":125,\"596\":125,\"597\":125,\"598\":125,\"599\":125,\"600\":125,\"601\":126,\"602\":125,\"603\":125,\"604\":125,\"605\":125,\"606\":125,\"607\":125,\"608\":125,\"609\":125,\"610\":125,\"611\":126,\"612\":125,\"613\":125,\"614\":125,\"615\":125,\"616\":125,\"617\":125,\"618\":125,\"619\":125,\"620\":125,\"621\":126,\"622\":125,\"623\":125,\"624\":125,\"625\":125,\"626\":125,\"627\":125,\"628\":125,\"629\":125,\"630\":125,\"631\":126,\"632\":125,\"633\":125,\"634\":125,\"635\":125,\"636\":125,\"637\":125,\"638\":125,\"639\":125,\"640\":125,\"641\":126,\"642\":125,\"643\":125,\"644\":125,\"645\":125,\"646\":125,\"647\":125,\"648\":125,\"649\":125,\"650\":125,\"651\":126,\"652\":125,\"653\":125,\"654\":125,\"655\":125,\"656\":125,\"657\":125,\"658\":125,\"659\":125,\"660\":125,\"661\":126,\"662\":125,\"663\":125,\"664\":125,\"665\":125,\"666\":125,\"667\":125,\"668\":125,\"669\":125,\"670\":125,\"671\":126,\"672\":125,\"673\":125,\"674\":125,\"675\":125,\"676\":125,\"677\":125,\"678\":125,\"679\":125,\"680\":125,\"681\":126,\"682\":125,\"683\":125,\"684\":125,\"685\":125,\"686\":125,\"687\":125,\"688\":125,\"689\":125,\"690\":125,\"691\":126,\"692\":125,\"693\":125,\"694\":125,\"695\":125,\"696\":125,\"697\":125,\"698\":125,\"699\":125,\"700\":125,\"701\":126,\"702\":125,\"703\":125,\"704\":125,\"705\":125,\"706\":125,\"707\":125,\"708\":125,\"709\":125,\"710\":125,\"711\":126,\"712\":125,\"713\":125,\"714\":125,\"715\":125,\"716\":125,\"717\":125,\"718\":125,\"719\":125,\"720\":125,\"721\":126,\"722\":125,\"723\":125,\"724\":125,\"725\":125,\"726\":125,\"727\":125,\"728\":125,\"729\":125,\"730\":125,\"731\":126,\"732\":125,\"733\":125,\"734\":125,\"735\":125,\"736\":125,\"737\":125,\"738\":125,\"739\":125,\"740\":125,\"741\":126,\"742\":125,\"743\":125,\"744\":125,\"745\":125,\"746\":125,\"747\":125,\"748\":125,\"749\":125,\"750\":125,\"751\":126,\"752\":125,\"753\":125,\"754\":125,\"755\":125,\"756\":125,\"757\":125,\"758\":125,\"759\":125,\"760\":125,\"761\":126,\"762\":125,\"763\":125,\"764\":125,\"765\":125,\"766\":125,\"767\":125,\"768\":125,\"769\":125,\"770\":125,\"771\":126,\"772\":125,\"773\":125,\"774\":125,\"775\":125,\"776\":125,\"777\":125,\"778\":125,\"779\":125,\"780\":125,\"781\":126,\"782\":125,\"783\":125,\"784\":125,\"785\":125,\"786\":125,\"787\":125,\"788\":125,\"789\":125,\"790\":125,\"791\":126,\"792\":125,\"793\":125,\"794\":125,\"795\":125,\"796\":125,\"797\":125,\"798\":125,\"799\":125,\"800\":125,\"801\":126,\"802\":125,\"803\":125,\"804\":125,\"805\":125,\"806\":125,\"807\":125,\"808\":125,\"809\":125,\"810\":125,\"811\":126,\"812\":125,\"813\":125,\"814\":125,\"815\":125,\"816\":125,\"817\":125,\"818\":125,\"819\":125,\"820\":125,\"821\":126,\"822\":125,\"823\":125,\"824\":125,\"825\":125,\"826\":125,\"827\":125,\"828\":125,\"829\":125,\"830\":125,\"831\":126,\"832\":125,\"833\":125,\"834\":125,\"835\":125,\"836\":125,\"837\":125,\"838\":125,\"839\":125,\"840\":125,\"841\":126,\"842\":125,\"843\":125,\"844\":125,\"845\":125,\"846\":125,\"847\":125,\"848\":125,\"849\":125,\"850\":125,\"851\":126,\"852\":125,\"853\":125,\"854\":125,\"855\":125,\"856\":125,\"857\":125,\"858\":125,\"859\":125,\"860\":125,\"861\":126,\"862\":125,\"863\":125,\"864\":125,\"865\":125,\"866\":125,\"867\":125,\"868\":125,\"869\":125,\"870\":125,\"871\":126,\"872\":125,\"873\":125,\"874\":125,\"875\":125,\"876\":125,\"877\":125,\"878\":125,\"879\":125,\"880\":125,\"881\":126,\"882\":125,\"883\":125,\"884\":125,\"885\":125,\"886\":125,\"887\":125,\"888\":125,\"889\":125,\"890\":125,\"891\":126,\"892\":125,\"893\":125,\"894\":125,\"895\":125,\"896\":125,\"897\":125,\"898\":125,\"899\":125,\"900\":125,\"901\":126,\"902\":125,\"903\":125,\"904\":125,\"905\":125,\"906\":125,\"907\":125,\"908\":125,\"909\":125,\"910\":125,\"911\":126,\"912\":125,\"913\":125,\"914\":125,\"915\":125,\"916\":125,\"917\":125,\"918\":125,\"919\":125,\"920\":125,\"921\":126,\"922\":125,\"923\":125,\"924\":125,\"925\":125,\"926\":125,\"927\":125,\"928\":125,\"929\":125,\"930\":125,\"931\":126,\"932\":125,\"933\":125,\"934\":125,\"935\":125,\"936\":125,\"937\":125,\"938\":125,\"939\":125,\"940\":125,\"941\":126,\"942\":125,\"943\":125,\"944\":125,\"945\":125,\"946\":125,\"947\":125,\"948\":125,\"949\":125,\"950\":125,\"951\":126,\"952\":125,\"953\":125,\"954\":125,\"955\":125,\"956\":125,\"957\":125,\"958\":125,\"959\":125,\"960\":125,\"961\":126,\"962\":125,\"963\":125,\"964\":125,\"965\":125,\"966\":125,\"967\":125,\"968\":125,\"969\":125,\"970\":125,\"971\":126,\"972\":125,\"973\":125,\"974\":125,\"975\":125,\"976\":125,\"977\":125,\"978\":125,\"979\":125,\"980\":125,\"981\":126,\"982\":125,\"983\":125,\"984\":125,\"985\":125,\"986\":125,\"987\":125,\"988\":125,\"989\":125,\"990\":125,\"991\":126,\"992\":125,\"993\":125,\"994\":125,\"995\":125,\"996\":125,\"997\":125,\"998\":125,\"999\":125,\"000\":125,\"001\":126,\"002\":125,\"003\":125,\"004\":125,\"005\":125,\"006\":125,\"007\":125,\"008\":125,\"009\":125,\"010\":125,\"011\":126,\"012\":125,\"013\":125,\"014\":125,\"015\":125,\"016\":125,\"017\":125,\"018\":125,\"019\":125,\"020\":125,\"021\":126,\"022\":125,\"023\":125,\"024\":125,\"025\":125,\"026\":125,\"027\":125,\"028\":125,\"029\":125,\"030\":125,\"031\":126,\"032\":125,\"033\":125,\"034\":125,\"035\":125,\"036\":125,\"037\":125,\"038\":125,\"039\":125,\"040\":125,\"041\":126,\"042\":125,\"043\":125,\"044\":125,\"045\":125,\"046\":125,\"047\":125,\"048\":125,\"049\":125,\"050\":125,\"051\":126,\"052\":125,\"053\":125,\"054\":125,\"055\":125,\"056\":125,\"057\":125,\"058\":125,\"059\":125,\"060\":125,\"061\":126,\"062\":125,\"063\":125,\"064\":125,\"065\":125,\"066\":125,\"067\":125,\"068\":125,\"069\":125,\"070\":125,\"071\":126,\"072\":125,\"073\":125,\"074\":125,\"075\":125,\"076\":125,\"077\":125,\"078\":125,\"079\":125,\"080\":125,\"081\":126,\"082\":125,\"083\":125,\"084\":125,\"085\":125,\"086\":125,\"087\":125,\"088\":125,\"089\":125,\"090\":125,\"091\":126,\"092\":125,\"093\":125,\"094\":125,\"095\":125,\"096\":125,\"097\":125,\"098\":125,\"099\":125},\"versionIdList\":[125,126],\"versionMap\":{\"125\":{\"id\":125,\"labId\":54,\"versionName\":\"v1\",\"description\":\"\",\"whitelist\":\"\",\"baselineState\":0,\"integrationState\":\"test_succeed\",\"labVariableName\":\"广告pctr模型01\",\"labVariableCode\":\"ad-pctr-model-01\",\"diversionType\":\"hash_imei\",\"diversionStrategy\":\"0,2,3,4,5,6,7,8,9\",\"trafficRatio\":900,\"interventionStrategy\":\"\",\"shuntTagStrategy\":\"\",\"createTime\":1573089983000,\"updateTime\":1573090420564,\"params\":{\"pctr\":1,\"ds\":\"1\"},\"creator\":\"林承君\",\"modifier\":\"林承君\"},\"126\":{\"id\":126,\"labId\":54,\"versionName\":\"v2\",\"description\":\"\",\"whitelist\":\"\",\"baselineState\":1,\"integrationState\":\"test_succeed\",\"labVariableName\":\"广告pctr模型01\",\"labVariableCode\":\"ad-pctr-model-01\",\"diversionType\":\"hash_imei\",\"diversionStrategy\":\"1\",\"trafficRatio\":100,\"interventionStrategy\":\"\",\"shuntTagStrategy\":\"\",\"createTime\":1573090086000,\"updateTime\":1573090420564,\"params\":{\"pctr\":2,\"ds\":\"2\"},\"creator\":\"林承君\",\"modifier\":\"林承君\"}}},\"前端测试120401\":{\"lab\":{\"id\":81,\"labName\":\"前端测试120401\",\"description\":\"\",\"factor\":\"abc\",\"labState\":\"effective\",\"labType\":\"product\",\"moduleId\":12,\"sceneId\":38,\"sceneCode\":\"scene_1106\",\"trafficAllocationType\":\"tag_with_segment\",\"bizLineName\":\"ad\",\"createTime\":1575397907219,\"updateTime\":1575523886745,\"creator\":\"李冕\",\"modifier\":\"李冕\",\"hashEncrypt\":1,\"hashSwitch\":1,\"subType\":\"flowControl\",\"relatedLayer\":0,\"layerId\":-1,\"shuntField\":\"ADDITIONAL_TAG\",\"shuntTagType\":\"SYSTEM_VERSION\",\"saltSwitch\":0,\"saltLocation\":1},\"hashMatchLength\":3,\"whitelistMap\":{},\"segmentMap\":{\"100\":185,\"101\":185,\"102\":185,\"103\":185,\"104\":200,\"105\":185,\"106\":185,\"107\":185,\"108\":185,\"109\":185,\"110\":185,\"111\":185,\"112\":185,\"113\":185,\"114\":200,\"115\":185,\"116\":185,\"117\":185,\"118\":185,\"119\":185,\"120\":185,\"121\":185,\"122\":185,\"123\":185,\"124\":200,\"125\":185,\"126\":185,\"127\":185,\"128\":185,\"129\":185,\"130\":185,\"131\":185,\"132\":185,\"133\":185,\"134\":200,\"135\":185,\"136\":185,\"137\":185,\"138\":185,\"139\":185,\"140\":185,\"141\":185,\"142\":185,\"143\":185,\"144\":200,\"145\":185,\"146\":185,\"147\":185,\"148\":185,\"149\":185,\"150\":185,\"151\":185,\"152\":185,\"153\":185,\"154\":200,\"155\":185,\"156\":185,\"157\":185,\"158\":185,\"159\":185,\"160\":185,\"161\":185,\"162\":185,\"163\":185,\"164\":200,\"165\":185,\"166\":185,\"167\":185,\"168\":185,\"169\":185,\"170\":185,\"171\":185,\"172\":185,\"173\":185,\"174\":200,\"175\":185,\"176\":185,\"177\":185,\"178\":185,\"179\":185,\"180\":185,\"181\":185,\"182\":185,\"183\":185,\"184\":200,\"185\":185,\"186\":185,\"187\":185,\"188\":185,\"189\":185,\"190\":185,\"191\":185,\"192\":185,\"193\":185,\"194\":200,\"195\":185,\"196\":185,\"197\":185,\"198\":185,\"199\":185,\"200\":185,\"201\":185,\"202\":185,\"203\":185,\"204\":200,\"205\":185,\"206\":185,\"207\":185,\"208\":185,\"209\":185,\"210\":185,\"211\":185,\"212\":185,\"213\":185,\"214\":200,\"215\":185,\"216\":185,\"217\":185,\"218\":185,\"219\":185,\"220\":185,\"221\":185,\"222\":185,\"223\":185,\"224\":200,\"225\":185,\"226\":185,\"227\":185,\"228\":185,\"229\":185,\"230\":185,\"231\":185,\"232\":185,\"233\":185,\"234\":200,\"235\":185,\"236\":185,\"237\":185,\"238\":185,\"239\":185,\"240\":185,\"241\":185,\"242\":185,\"243\":185,\"244\":200,\"245\":185,\"246\":185,\"247\":185,\"248\":185,\"249\":185,\"250\":185,\"251\":185,\"252\":185,\"253\":185,\"254\":200,\"255\":185,\"256\":185,\"257\":185,\"258\":185,\"259\":185,\"260\":185,\"261\":185,\"262\":185,\"263\":185,\"264\":200,\"265\":185,\"266\":185,\"267\":185,\"268\":185,\"269\":185,\"270\":185,\"271\":185,\"272\":185,\"273\":185,\"274\":200,\"275\":185,\"276\":185,\"277\":185,\"278\":185,\"279\":185,\"280\":185,\"281\":185,\"282\":185,\"283\":185,\"284\":200,\"285\":185,\"286\":185,\"287\":185,\"288\":185,\"289\":185,\"290\":185,\"291\":185,\"292\":185,\"293\":185,\"294\":200,\"295\":185,\"296\":185,\"297\":185,\"298\":185,\"299\":185,\"300\":185,\"301\":185,\"302\":185,\"303\":185,\"304\":200,\"305\":185,\"306\":185,\"307\":185,\"308\":185,\"309\":185,\"310\":185,\"311\":185,\"312\":185,\"313\":185,\"314\":200,\"315\":185,\"316\":185,\"317\":185,\"318\":185,\"319\":185,\"320\":185,\"321\":185,\"322\":185,\"323\":185,\"324\":200,\"325\":185,\"326\":185,\"327\":185,\"328\":185,\"329\":185,\"330\":185,\"331\":185,\"332\":185,\"333\":185,\"334\":200,\"335\":185,\"336\":185,\"337\":185,\"338\":185,\"339\":185,\"340\":185,\"341\":185,\"342\":185,\"343\":185,\"344\":200,\"345\":185,\"346\":185,\"347\":185,\"348\":185,\"349\":185,\"350\":185,\"351\":185,\"352\":185,\"353\":185,\"354\":200,\"355\":185,\"356\":185,\"357\":185,\"358\":185,\"359\":185,\"360\":185,\"361\":185,\"362\":185,\"363\":185,\"364\":200,\"365\":185,\"366\":185,\"367\":185,\"368\":185,\"369\":185,\"370\":185,\"371\":185,\"372\":185,\"373\":185,\"374\":200,\"375\":185,\"376\":185,\"377\":185,\"378\":185,\"379\":185,\"380\":185,\"381\":185,\"382\":185,\"383\":185,\"384\":200,\"385\":185,\"386\":185,\"387\":185,\"388\":185,\"389\":185,\"390\":185,\"391\":185,\"392\":185,\"393\":185,\"394\":200,\"395\":185,\"396\":185,\"397\":185,\"398\":185,\"399\":185,\"400\":185,\"401\":185,\"402\":185,\"403\":185,\"404\":200,\"405\":185,\"406\":185,\"407\":185,\"408\":185,\"409\":185,\"410\":185,\"411\":185,\"412\":185,\"413\":185,\"414\":200,\"415\":185,\"416\":185,\"417\":185,\"418\":185,\"419\":185,\"420\":185,\"421\":185,\"422\":185,\"423\":185,\"424\":200,\"425\":185,\"426\":185,\"427\":185,\"428\":185,\"429\":185,\"430\":185,\"431\":185,\"432\":185,\"433\":185,\"434\":200,\"435\":185,\"436\":185,\"437\":185,\"438\":185,\"439\":185,\"440\":185,\"441\":185,\"442\":185,\"443\":185,\"444\":200,\"445\":185,\"446\":185,\"447\":185,\"448\":185,\"449\":185,\"450\":185,\"451\":185,\"452\":185,\"453\":185,\"454\":200,\"455\":185,\"456\":185,\"457\":185,\"458\":185,\"459\":185,\"460\":185,\"461\":185,\"462\":185,\"463\":185,\"464\":200,\"465\":185,\"466\":185,\"467\":185,\"468\":185,\"469\":185,\"470\":185,\"471\":185,\"472\":185,\"473\":185,\"474\":200,\"475\":185,\"476\":185,\"477\":185,\"478\":185,\"479\":185,\"480\":185,\"481\":185,\"482\":185,\"483\":185,\"484\":200,\"485\":185,\"486\":185,\"487\":185,\"488\":185,\"489\":185,\"490\":185,\"491\":185,\"492\":185,\"493\":185,\"494\":200,\"495\":185,\"496\":185,\"497\":185,\"498\":185,\"499\":185,\"500\":185,\"501\":185,\"502\":185,\"503\":185,\"504\":200,\"505\":185,\"506\":185,\"507\":185,\"508\":185,\"509\":185,\"510\":185,\"511\":185,\"512\":185,\"513\":185,\"514\":200,\"515\":185,\"516\":185,\"517\":185,\"518\":185,\"519\":185,\"520\":185,\"521\":185,\"522\":185,\"523\":185,\"524\":200,\"525\":185,\"526\":185,\"527\":185,\"528\":185,\"529\":185,\"530\":185,\"531\":185,\"532\":185,\"533\":185,\"534\":200,\"535\":185,\"536\":185,\"537\":185,\"538\":185,\"539\":185,\"540\":185,\"541\":185,\"542\":185,\"543\":185,\"544\":200,\"545\":185,\"546\":185,\"547\":185,\"548\":185,\"549\":185,\"550\":185,\"551\":185,\"552\":185,\"553\":185,\"554\":200,\"555\":185,\"556\":185,\"557\":185,\"558\":185,\"559\":185,\"560\":185,\"561\":185,\"562\":185,\"563\":185,\"564\":200,\"565\":185,\"566\":185,\"567\":185,\"568\":185,\"569\":185,\"570\":185,\"571\":185,\"572\":185,\"573\":185,\"574\":200,\"575\":185,\"576\":185,\"577\":185,\"578\":185,\"579\":185,\"580\":185,\"581\":185,\"582\":185,\"583\":185,\"584\":200,\"585\":185,\"586\":185,\"587\":185,\"588\":185,\"589\":185,\"590\":185,\"591\":185,\"592\":185,\"593\":185,\"594\":200,\"595\":185,\"596\":185,\"597\":185,\"598\":185,\"599\":185,\"600\":185,\"601\":185,\"602\":185,\"603\":185,\"604\":200,\"605\":185,\"606\":185,\"607\":185,\"608\":185,\"609\":185,\"610\":185,\"611\":185,\"612\":185,\"613\":185,\"614\":200,\"615\":185,\"616\":185,\"617\":185,\"618\":185,\"619\":185,\"620\":185,\"621\":185,\"622\":185,\"623\":185,\"624\":200,\"625\":185,\"626\":185,\"627\":185,\"628\":185,\"629\":185,\"630\":185,\"631\":185,\"632\":185,\"633\":185,\"634\":200,\"635\":185,\"636\":185,\"637\":185,\"638\":185,\"639\":185,\"640\":185,\"641\":185,\"642\":185,\"643\":185,\"644\":200,\"645\":185,\"646\":185,\"647\":185,\"648\":185,\"649\":185,\"650\":185,\"651\":185,\"652\":185,\"653\":185,\"654\":200,\"655\":185,\"656\":185,\"657\":185,\"658\":185,\"659\":185,\"660\":185,\"661\":185,\"662\":185,\"663\":185,\"664\":200,\"665\":185,\"666\":185,\"667\":185,\"668\":185,\"669\":185,\"670\":185,\"671\":185,\"672\":185,\"673\":185,\"674\":200,\"675\":185,\"676\":185,\"677\":185,\"678\":185,\"679\":185,\"680\":185,\"681\":185,\"682\":185,\"683\":185,\"684\":200,\"685\":185,\"686\":185,\"687\":185,\"688\":185,\"689\":185,\"690\":185,\"691\":185,\"692\":185,\"693\":185,\"694\":200,\"695\":185,\"696\":185,\"697\":185,\"698\":185,\"699\":185,\"700\":185,\"701\":185,\"702\":185,\"703\":185,\"704\":200,\"705\":185,\"706\":185,\"707\":185,\"708\":185,\"709\":185,\"710\":185,\"711\":185,\"712\":185,\"713\":185,\"714\":200,\"715\":185,\"716\":185,\"717\":185,\"718\":185,\"719\":185,\"720\":185,\"721\":185,\"722\":185,\"723\":185,\"724\":200,\"725\":185,\"726\":185,\"727\":185,\"728\":185,\"729\":185,\"730\":185,\"731\":185,\"732\":185,\"733\":185,\"734\":200,\"735\":185,\"736\":185,\"737\":185,\"738\":185,\"739\":185,\"740\":185,\"741\":185,\"742\":185,\"743\":185,\"744\":200,\"745\":185,\"746\":185,\"747\":185,\"748\":185,\"749\":185,\"750\":185,\"751\":185,\"752\":185,\"753\":185,\"754\":200,\"755\":185,\"756\":185,\"757\":185,\"758\":185,\"759\":185,\"760\":185,\"761\":185,\"762\":185,\"763\":185,\"764\":200,\"765\":185,\"766\":185,\"767\":185,\"768\":185,\"769\":185,\"770\":185,\"771\":185,\"772\":185,\"773\":185,\"774\":200,\"775\":185,\"776\":185,\"777\":185,\"778\":185,\"779\":185,\"780\":185,\"781\":185,\"782\":185,\"783\":185,\"784\":200,\"785\":185,\"786\":185,\"787\":185,\"788\":185,\"789\":185,\"790\":185,\"791\":185,\"792\":185,\"793\":185,\"794\":200,\"795\":185,\"796\":185,\"797\":185,\"798\":185,\"799\":185,\"800\":185,\"801\":185,\"802\":185,\"803\":185,\"804\":200,\"805\":185,\"806\":185,\"807\":185,\"808\":185,\"809\":185,\"810\":185,\"811\":185,\"812\":185,\"813\":185,\"814\":200,\"815\":185,\"816\":185,\"817\":185,\"818\":185,\"819\":185,\"820\":185,\"821\":185,\"822\":185,\"823\":185,\"824\":200,\"825\":185,\"826\":185,\"827\":185,\"828\":185,\"829\":185,\"830\":185,\"831\":185,\"832\":185,\"833\":185,\"834\":200,\"835\":185,\"836\":185,\"837\":185,\"838\":185,\"839\":185,\"840\":185,\"841\":185,\"842\":185,\"843\":185,\"844\":200,\"845\":185,\"846\":185,\"847\":185,\"848\":185,\"849\":185,\"850\":185,\"851\":185,\"852\":185,\"853\":185,\"854\":200,\"855\":185,\"856\":185,\"857\":185,\"858\":185,\"859\":185,\"860\":185,\"861\":185,\"862\":185,\"863\":185,\"864\":200,\"865\":185,\"866\":185,\"867\":185,\"868\":185,\"869\":185,\"870\":185,\"871\":185,\"872\":185,\"873\":185,\"874\":200,\"875\":185,\"876\":185,\"877\":185,\"878\":185,\"879\":185,\"880\":185,\"881\":185,\"882\":185,\"883\":185,\"884\":200,\"885\":185,\"886\":185,\"887\":185,\"888\":185,\"889\":185,\"890\":185,\"891\":185,\"892\":185,\"893\":185,\"894\":200,\"895\":185,\"896\":185,\"897\":185,\"898\":185,\"899\":185,\"900\":185,\"901\":185,\"902\":185,\"903\":185,\"904\":200,\"905\":185,\"906\":185,\"907\":185,\"908\":185,\"909\":185,\"910\":185,\"911\":185,\"912\":185,\"913\":185,\"914\":200,\"915\":185,\"916\":185,\"917\":185,\"918\":185,\"919\":185,\"920\":185,\"921\":185,\"922\":185,\"923\":185,\"924\":200,\"925\":185,\"926\":185,\"927\":185,\"928\":185,\"929\":185,\"930\":185,\"931\":185,\"932\":185,\"933\":185,\"934\":200,\"935\":185,\"936\":185,\"937\":185,\"938\":185,\"939\":185,\"940\":185,\"941\":185,\"942\":185,\"943\":185,\"944\":200,\"945\":185,\"946\":185,\"947\":185,\"948\":185,\"949\":185,\"950\":185,\"951\":185,\"952\":185,\"953\":185,\"954\":200,\"955\":185,\"956\":185,\"957\":185,\"958\":185,\"959\":185,\"960\":185,\"961\":185,\"962\":185,\"963\":185,\"964\":200,\"965\":185,\"966\":185,\"967\":185,\"968\":185,\"969\":185,\"970\":185,\"971\":185,\"972\":185,\"973\":185,\"974\":200,\"975\":185,\"976\":185,\"977\":185,\"978\":185,\"979\":185,\"980\":185,\"981\":185,\"982\":185,\"983\":185,\"984\":200,\"985\":185,\"986\":185,\"987\":185,\"988\":185,\"989\":185,\"990\":185,\"991\":185,\"992\":185,\"993\":185,\"994\":200,\"995\":185,\"996\":185,\"997\":185,\"998\":185,\"999\":185,\"000\":185,\"001\":185,\"002\":185,\"003\":185,\"004\":200,\"005\":185,\"006\":185,\"007\":185,\"008\":185,\"009\":185,\"010\":185,\"011\":185,\"012\":185,\"013\":185,\"014\":200,\"015\":185,\"016\":185,\"017\":185,\"018\":185,\"019\":185,\"020\":185,\"021\":185,\"022\":185,\"023\":185,\"024\":200,\"025\":185,\"026\":185,\"027\":185,\"028\":185,\"029\":185,\"030\":185,\"031\":185,\"032\":185,\"033\":185,\"034\":200,\"035\":185,\"036\":185,\"037\":185,\"038\":185,\"039\":185,\"040\":185,\"041\":185,\"042\":185,\"043\":185,\"044\":200,\"045\":185,\"046\":185,\"047\":185,\"048\":185,\"049\":185,\"050\":185,\"051\":185,\"052\":185,\"053\":185,\"054\":200,\"055\":185,\"056\":185,\"057\":185,\"058\":185,\"059\":185,\"060\":185,\"061\":185,\"062\":185,\"063\":185,\"064\":200,\"065\":185,\"066\":185,\"067\":185,\"068\":185,\"069\":185,\"070\":185,\"071\":185,\"072\":185,\"073\":185,\"074\":200,\"075\":185,\"076\":185,\"077\":185,\"078\":185,\"079\":185,\"080\":185,\"081\":185,\"082\":185,\"083\":185,\"084\":200,\"085\":185,\"086\":185,\"087\":185,\"088\":185,\"089\":185,\"090\":185,\"091\":185,\"092\":185,\"093\":185,\"094\":200,\"095\":185,\"096\":185,\"097\":185,\"098\":185,\"099\":185},\"versionIdList\":[184,185,200],\"versionMap\":{\"184\":{\"id\":184,\"labId\":81,\"versionName\":\"v1\",\"description\":\"\",\"whitelist\":\"\",\"baselineState\":1,\"integrationState\":\"test_succeed\",\"labVariableName\":\"产品实验参数模板1\",\"labVariableCode\":\"code75032\",\"diversionType\":\"hash_imei\",\"diversionStrategy\":\"\",\"trafficRatio\":0,\"interventionStrategy\":\"\",\"shuntTagStrategy\":\"\",\"createTime\":1575397923000,\"updateTime\":1575656006000,\"params\":{\"a\":\"asd\",\"b\":123},\"creator\":\"李冕\",\"modifier\":\"李冕\"},\"185\":{\"id\":185,\"labId\":81,\"versionName\":\"v2\",\"description\":\"\",\"whitelist\":\"\",\"baselineState\":0,\"integrationState\":\"test_succeed\",\"labVariableName\":\"产品实验参数模板1\",\"labVariableCode\":\"code75032\",\"diversionType\":\"hash_imei\",\"diversionStrategy\":\"2\",\"trafficRatio\":100,\"interventionStrategy\":\"\",\"shuntTagStrategy\":\"asd,/asff,da's'd,1.24,7.1,8.0,7.2,8.1,3.1.0,8.2,135.0,ds\",\"createTime\":1575397933000,\"updateTime\":1575656006000,\"params\":{\"a\":\"asd\",\"b\":234},\"creator\":\"李冕\",\"modifier\":\"李冕\"},\"200\":{\"id\":200,\"labId\":81,\"versionName\":\"v3\",\"description\":\"\",\"whitelist\":\"\",\"baselineState\":1,\"integrationState\":\"skip_test\",\"labVariableName\":\"产品实验参数模板1\",\"labVariableCode\":\"code75032\",\"diversionType\":\"hash_imei\",\"diversionStrategy\":\"4\",\"trafficRatio\":100,\"interventionStrategy\":\"\",\"shuntTagStrategy\":\"\",\"createTime\":1575655947000,\"updateTime\":1575656006000,\"params\":{\"a\":\"zxc\",\"b\":23},\"creator\":\"李冕\",\"modifier\":\"李冕\"}}}},\"lastAccumulateUpdatedTime\":12596666333160}";
    std::shared_ptr<VepApiSceneVo> scene_vo = std::make_shared<VepApiSceneVo>();
    VepDeserializeUtils::DeserializeVepApiSceneVo(json_str, scene_vo);
    //scene
    EXPECT_EQ(38, scene_vo->scene.id);
    EXPECT_EQ("ad_1107", scene_vo->scene.module_code);
    //labNameList
    EXPECT_EQ(2, (int)(scene_vo->lab_name_list.size()));
    //last_accumulate_updated_time
    EXPECT_EQ(12596666333160, (long)(scene_vo->last_accumulate_updated_time));
    //labMap
    EXPECT_EQ(2, (int)(scene_vo->lab_map.size()));
    std::shared_ptr<VepApiLabVo> &lab_vo = scene_vo->lab_map["lab-1106"];
    //1.lab
    EXPECT_EQ(54, lab_vo->lab.id);
    EXPECT_EQ("scene_1106", lab_vo->lab.scene_code);
    //2.versionMap
    EXPECT_EQ(2, (int)(lab_vo->version_map.size()));
    std::shared_ptr<LabVersionDto> lab_version_dto = lab_vo->version_map[125];  //取出vector中的第一个
    EXPECT_EQ(125, lab_version_dto->id);
}

TEST(VepDeserializeUtils, DeserializeVivoCfgResultVo){
    std::string json_str = "{\"retcode\":0,\"message\":\"SUCCESS\",\"data\":{\"requestTimestamp\":1576221962270,\"responseTimestamp\":1576221962275,\"configs\":[{\"name\":\"long.polling.timeout.milliseconds\",\"value\":\"120000\",\"isEncrypted\":0,\"lastModified\":1571813759000},{\"name\":\"scheduled.report.interval\",\"value\":\"75000\",\"isEncrypted\":0,\"lastModified\":1571813759000},{\"name\":\"buried.log.fields_1.0.0\",\"value\":\"algCode\",\"isEncrypted\":0,\"lastModified\":1571813759000},{\"name\":\"default.api.server.url\",\"value\":\"http://10.101.34.38:8080\",\"isEncrypted\":0,\"lastModified\":1571813759000},{\"name\":\"fetch.failed.count.threshold\",\"value\":\"5\",\"isEncrypted\":0,\"lastModified\":1571813759000},{\"name\":\"client.report.api.server.url\",\"value\":\"http://10.101.34.38:8080\",\"isEncrypted\":0,\"lastModified\":1571813759000},{\"name\":\"request.timeout.milliseconds\",\"value\":\"5000\",\"isEncrypted\":0,\"lastModified\":1571813759000},{\"name\":\"scheduled.watch.interval\",\"value\":\"200\",\"isEncrypted\":0,\"lastModified\":1571813759000},{\"name\":\"scheduled.fetch.interval\",\"value\":\"60000\",\"isEncrypted\":0,\"lastModified\":1571813759000}],\"lastModified\":1560828169537,\"realConfigVersion\":\"1\"}}";
    VivoCfgResultVo cfgResultVo;
    VepDeserializeUtils::DeserializeVivoCfgResultVo(json_str, &cfgResultVo);

    EXPECT_EQ(0, cfgResultVo.retcode);
    EXPECT_EQ("SUCCESS", cfgResultVo.message);
    //CfgResultData
    EXPECT_EQ(1560828169537, (long)(cfgResultVo.data.last_modified));
    //std::vector<PropertyItem> configs
    EXPECT_EQ(9, (int)(cfgResultVo.data.configs.size()));

    std::map<std::string, std::string> http_ret_map;  //将list对象转换为map存储
    std::vector<PropertyItem> property_item_list = cfgResultVo.data.configs;
    for(auto propertyItem : property_item_list){
        http_ret_map.insert({propertyItem.name, propertyItem.value});
    }

    EXPECT_EQ("http://10.101.34.38:8080", http_ret_map["default.api.server.url"]);
}

} //namespace common
